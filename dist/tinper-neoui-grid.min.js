!function(){"use strict";var init=function(t,i){this.defaults={},this.gridComp=i,this.options=$.extend({},this.defaults,t),this.rows=new Array,this.hasParentRows=new Array,this.nothasParentRows=new Array},sortRows=function(t,i){"function"==typeof this.gridComp.options.filterDataFun&&(this.options.values=this.gridComp.options.filterDataFun.call(this,this.options.values)),this.gridComp.options.showTree?this.treeSortRows(t,i):this.basicSortRows(t,i),this.gridComp.eidtRowIndex=-1},basicSortRows=function(t,i){var e=this;t&&this.gridComp.getColumnByField(t).options.dataType,this.rows=new Array,this.groupRows=new Array,this.options.values&&$.each(this.options.values,function(t){var i={};i.value=this,i.valueIndex=t,e.rows.push(i),e.gridComp.getGroupIndex(this,t,i),e.rows=e.getGroupRows()})},treeSortRows=function(t,i){this.basicSortRows(t,i)},getSumValue=function(t,i,e){var o=null;if(i.options.sumCol&&$.each(this.rows,function(n){var s=$(this.value).attr(t);"Int"==i.options.dataType?(s=e.getInt(s,0),o+=parseInt(s)):(s=e.getFloat(s,0),o=e.accAdd(o,parseFloat(s)))}),"Float"==i.options.dataType&&i.options.precision){var n={};n.value=o,n.precision=i.options.precision,o=e.DicimalFormater(n)}return null!=o&&void 0!=o&&"null"!=o&&"undefined"!=o?o+"":""},getGroupSumValue=function(t,i,e){var o=null,n=this.gridComp;if(i.options.sumCol&&$.each(e.rows,function(e){var s=$(this.value).attr(t);"Int"==i.options.dataType?(s=n.getInt(s,0),o+=parseInt(s)):(s=n.getFloat(s,0),o=n.accAdd(o,parseFloat(s)))}),"Float"==i.options.dataType&&i.options.precision){var s={};s.value=o,s.precision=i.options.precision,o=n.DicimalFormater(s)}return null!=o&&void 0!=o&&"null"!=o&&"undefined"!=o?o+"":""},addOneRowGroup=function(t){var i=this.gridComp.options.groupField,e=!1;if(i){var o=this.gridComp.getString($(t.value).attr(i),"");if(this.groupRows||(this.groupRows=new Array),$.each(this.groupRows,function(i){var n=this;n.value==o&&(e=!0,n.length=parseInt(n.length)+1,n.rows.push(t))}),!e){var n={value:o,length:1,rows:[t]};this.groupRows.push(n)}}},getGroupRows=function(){var t=this.gridComp.options.groupField,i=[];return t?this.groupRows&&this.groupRows.length>0&&$.each(this.groupRows,function(){$.each(this.rows,function(){i.push(this)})}):i=this.rows,i},initFunObj={init:init,sortRows:sortRows,basicSortRows:basicSortRows,treeSortRows:treeSortRows,getSumValue:getSumValue,getGroupSumValue:getGroupSumValue,addOneRowGroup:addOneRowGroup,getGroupRows:getGroupRows},sort_initEventFun=function(){var t=this;$("#"+this.options.id).on("mouseup",function(i){if($(i.target).closest("#"+t.options.id+"_header").length>0){if(t.mouseUpX=i.clientX,t.mouseUpY=i.clientY,t.mouseDownX==t.mouseUpX&&t.mouseDownY==t.mouseUpY){t.columnClickX=i.clientX,t.columnClickY=i.clientY;var e=$(i.target).closest("th")[0];$(i.target).hasClass("u-grid-header-columnmenu")||t.canSortable(i,e)}}else $(i.target).closest("#"+t.options.id+"_content").length})},sort_initGridEventFun=function(){},canSortable=function(t,i){var e=this,o=$(i),n=o.attr("field");if(this.getColumnAttr("sortable",n)){if(t.ctrlKey){var s=[];$(".u-grid-header-sort-priority").each(function(t,i){var e,o=$(i),n=parseInt(o.text()),r=o.closest("th").attr("field");o.parent().hasClass("uf-arrow-down")?e="asc":o.parent().hasClass("uf-arrow-up")&&(e="desc"),s[n-1]={field:r,sortType:e}});var r;if((r=o.find(".uf-arrow-down")).length>0){var d=parseInt(r.find(".u-grid-header-sort-priority").text());s[d-1].sortType="desc",r.removeClass("uf-arrow-down").addClass("uf-arrow-up")}else if((r=o.find(".uf-arrow-up")).length>0){for(var d=parseInt(r.find(".u-grid-header-sort-priority").text()),l=d;l<s.length;l++){var a=$("[field="+s[l].field+"]").find(".u-grid-header-sort-priority");a.text(parseInt(a.text())-1)}s.splice(d-1,1),r.remove()}else s.push({field:n,sortType:"asc"}),o.first().first().append('<span class="uf uf-arrow-down u-grid-header-sort-span" ></span>');this.dataSourceObj.sortRowsByPrio(s)}else $(".uf-arrow-down").parent().parent().parent()[0]==i?($(".uf-arrow-down").remove(),$(i.firstChild.firstChild)[0].insertAdjacentHTML("beforeEnd",'<span class="uf uf-arrow-up u-grid-header-sort-span" ></span>'),"function"==typeof this.options.onSortFun?this.options.onSortFun.call(this,n,"asc"):this.dataSourceObj.sortRows(n,"asc")):$(".uf-arrow-up").parent().parent().parent()[0]==i?($(".uf-arrow-up").remove(),"function"==typeof this.options.onSortFun?this.options.onSortFun.call(this):this.dataSourceObj.sortRows()):($(".uf-arrow-down").remove(),$(".uf-arrow-up").remove(),$(i.firstChild.firstChild)[0].insertAdjacentHTML("beforeEnd",'<span class="uf uf-arrow-down u-grid-header-sort-span"></span>'),"function"==typeof this.options.onSortFun?this.options.onSortFun.call(this,n,"desc"):this.dataSourceObj.sortRows(n,"desc"));e.repairContent(),e.afterGridDivsCreate()}},re_deleteOneRowTree=function(){this.options.showTree&&this.dataSourceObj.sortRows()},sortRowsByPrio=function sortRowsByPrio(prioArray,cancelSort){var oThis=this;cancelSort&&(this.rows=new Array,this.options.values&&$.each(this.options.values,function(t){var i={};i.value=this,i.valueIndex=t,oThis.rows.push(i)}));var evalStr=function t(i){return i==prioArray.length-1?"by(prioArray["+i+"].field, prioArray["+i+"].sortType)":"by(prioArray["+i+"].field, prioArray["+i+"].sortType,"+t(i+1)+")"},by=function(t,i,e){arguments.callee;return function(o,n){var s=$(o.value).attr(t),r=$(n.value).attr(t),d=oThis.gridComp.getColumnByField(t).options.dataType;if("Float"==d)return s=parseFloat(s),r=parseFloat(r),isNaN(s)?1:isNaN(r)?-1:s==r&&e?e():"asc"==i?s-r:r-s;if("Int"==d)return s=parseInt(s),r=parseInt(r),isNaN(s)?1:isNaN(r)?-1:s==r&&e?e():"asc"==i?s-r:r-s;s=oThis.gridComp.getString(s,""),r=oThis.gridComp.getString(r,"");try{var l=s.localeCompare(r);return 0===l&&e?e():0===l?0:"asc"==i?l:-l}catch(t){return 0}}};this.rows.sort(eval(evalStr(0)))},re_basicSortRows=function(t,i){var e=this,o=this.gridComp.options.groupField;if(!t)return this.rows=new Array,this.groupRows=new Array,void(this.options.values&&$.each(this.options.values,function(t){var i={};i.value=this,i.valueIndex=t,e.rows.push(i),e.addOneRowGroup(i),e.rows=e.getGroupRows()}));o&&t&&o!=t?(e.rows=[],$.each(this.groupRows,function(){var o=this;o.rows.sort(e.gridComp.SortByFun(t,i)),e.rows=e.rows.concat(o.rows)})):this.rows.sort(this.gridComp.SortByFun(t,i))},sortFunObj={sort_initEventFun:sort_initEventFun,sort_initGridEventFun:sort_initGridEventFun,re_basicSortRows:re_basicSortRows,canSortable:canSortable,deleteOneRowTree:re_deleteOneRowTree,sortRowsByPrio:sortRowsByPrio},re_initTree=function(t,i){return i.showTree&&(t.sortable=!1),t},re_initOptionsTree=function(){this.options.showTree&&(this.options.showNumCol=!1),this.options.treeAsync&&"function"!=typeof this.options.onTreeExpandFun&&alert("treeAsync 为true必须定义onTreeExpandFun")},re_clickFunTree=function(t){var i=this,e=$(t.target),o=e.closest("td");if(o.length>0){var n=o.parent(),s=this.getTrIndex(n),r=i.dataSourceObj.rows[s];if(r){var d=i.getChildRowIndex(r);if(e.hasClass("uf-reduce-s-o")||e.hasClass("uf-add-s-o")){var l=o.find(".uf-reduce-s-o"),a=o.find(".uf-add-s-o");if(l.length>0){if(l.removeClass("uf-reduce-s-o").addClass("uf-add-s-o"),d.length>0){var h=i.getAllChildRowIndex(r);$.each(h,function(){var t=$('tr[role="row"]:eq('+parseInt(this)+")",n.parent());t.css("display","none"),$("#"+i.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")").css("display","none"),$(".uf-reduce-s-o",t).removeClass("uf-reduce-s-o").addClass("uf-add-s-o")})}"form"==this.options.editType&&($("#"+this.options.id+"_multiSelect_edit").remove(null,!0),$("#"+this.options.id+"_numCol_edit").remove(null,!0),$("#"+this.options.id+"_edit_tr").remove(null,!0),$("#"+this.options.id+"_edit_tr1").remove(null,!0))}else if(a.length>0){if(this.options.treeAsync&&r.value.isParent){var u={};u.row=r,u.gridObj=this;var c=this.options.keyField,p=this.getString(r.value[c],"");u.keyValue=p,this.options.onTreeExpandFun.call(this,u)}a.removeClass("uf-add-s-o").addClass("uf-reduce-s-o"),d.length>0&&$.each(d,function(){$('tr[role="row"]:eq('+parseInt(this)+")",n.parent()).css("display","");$("#"+i.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")")[0];$("#"+i.options.id+"_content_multiSelect >div:nth-child("+(parseInt(this)+1)+")").css("display","")})}this.resetLeftHeight()}}}},re_addOneRowTree=function(t,i,e){var o,n=this,s=this.dataSourceObj.rows.length;if(this.options.showTree){this.hasParent=!1,this.hasChildF=!1;var r=this.options.keyField,d=this.options.parentKeyField,l=this.getString($(t).attr(r),"");e.keyValue=l;var a=this.getString($(t).attr(d),"");e.parentKeyValue=a;var h;if($.each(this.dataSourceObj.rows,function(t){var o=this.value,s=n.getString($(o).attr(r),""),u=n.getString($(o).attr(d),"");if(s==a){n.hasParent=!0,n.addRowParentIndex=t,h=n.getAllChildRow(this).length;var c=this.level;if(e.level=c+1,i=n.addRowParentIndex+h+1,!n.options.needTreeSort)return!1}if(u==l&&""!=l&&(n.hasChildF=!0),n.hasParent&&n.hasChildF)return!1}),this.hasParent||(e.level=0,i!=s&&(i=s)),this.hasParent){var u=$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]').eq(n.addRowParentIndex);u.removeClass("u-grid-content-leaf-row").addClass("u-grid-content-parent-row");var c=$(".uf-add-s-o",u);if(c.length>0||(o="block"),h>0);else{this.options.autoExpand&&(o="block");var p=$("div:eq(0)",u),c=$(".uf-add-s-o",u),m=$(".uf-reduce-s-o",u);if(this.options.autoExpand)var f='<span class="uf u-grid-content-tree-span uf-reduce-s-o"></span>';else var f='<span class="uf u-grid-content-tree-span uf-add-s-o"></span>';if(p.length>0&&0==c.length&&0==m.length){p[0].insertAdjacentHTML("afterBegin",f);s=parseInt(p[0].style.left)-16,(s>0||0==s)&&(p[0].style.left=s+"px")}c.length>0&&c.removeClass("uf-add-s-o").addClass("uf-reduce-s-o")}}}return{index:i,displayFlag:o}},re_addOneRowTreeHasChildF=function(t){if(this.hasChildF)this.dataSourceObj.sortRows(),this.repairContent();else{if(this.hasParent){var i=this.dataSourceObj.rows[this.addRowParentIndex];i.hasChild=!0,i.childRow.push(t),i.childRowIndex.push(t.valueIndex),t.parentRow=i,t.parentRowIndex=this.addRowParentIndex}t.hasChild=!1,t.childRow=new Array,t.childRowIndex=new Array}},re_updateValueAtTree=function(t,i,e,o){var n=this,s=this.options.keyField,r=this.options.parentKeyField;if(this.options.showTree&&(i==s||i==r)){var d=!1,l=!1;if($.each(this.dataSourceObj.rows,function(t){var o=this.value,a=n.getString($(o).attr(s),""),h=n.getString($(o).attr(r),"");i==s&&e==h&&(l=!0),i==r&&e==a&&(d=!0)}),l||d){var a=$(this.dataSourceObj.rows[t].value);this.deleteOneRow(t),this.addOneRow(a[0])}}return!this.options.showTree||i!=s&&i!=r||!l&&!d||(t=this.getRowIndexByValue(i,e)),t},getAllChildRow=function(t){return t.allChildRow=new Array,this.getAllChildRowFun(t,t.allChildRow),t.allChildRow},re_getChildRowIndex=function(t){var i=[],e=this;if(t.childRowIndex&&t.childRowIndex.length>0)for(var o=0;o<t.childRowIndex.length;o++)i.push(t.childRowIndex[o]);else t.childRow&&t.childRow.length>0&&$.each(t.childRow,function(){var t=e.getRowIndexByValue(e.options.keyField,this.keyValue);i.push(t)});return i},getAllChildRowIndex=function(t){return t.allChildRowIndex=new Array,this.getAllChildRowIndexFun(t,t.allChildRowIndex),t.allChildRowIndex},getAllChildRowFun=function(t,i){var e=this;t.childRow.length>0&&(Array.prototype.push.apply(i,t.childRow),$.each(t.childRow,function(){e.getAllChildRowFun(this,i)}))},getAllChildRowIndexFun=function(t,i){var e=this;t.childRow.length>0&&(Array.prototype.push.apply(i,this.getChildRowIndex(t)),$.each(t.childRow,function(){e.getAllChildRowIndexFun(this,i)}))},expandNode=function(t){var i=this.getRowIndexByValue(this.options.keyField,t);this.expandNodeByIndex(i)},expandNodeByIndex=function(t){for(var i,e=this.getRowByIndex(t),o=!1,n=new Array,s=e;!o;){if(""==s.parentKeyValue){o=!0;break}i=s.parentRowIndex,s=s.parentRow;var r=$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]').eq(i),d=$(".uf-add-s-o",r);if(!(d.length>0)){o=!0;break}n.push(i)}if(n.length>0)for(var l=n.length-1;l>-1;l--){var a=n[l],r=$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]').eq(a),d=$(".uf-add-s-o",r);d.click()}var h=$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]').eq(t),d=$(".uf-add-s-o",h),u=$(".u-grid-content-td-div",h);d.length>0?d.click():u.click()},re_treeSortRows=function(t,i){var e=this,o=new Array;if(this.rows=new Array,this.hasParentRows=new Array,this.nothasParentRows=new Array,this.options.values){$.each(this.options.values,function(t){var i={},o=$(this),n=e.gridComp.options.keyField,s=e.gridComp.options.parentKeyField,r=e.gridComp.getString(o.attr(n),""),d=e.gridComp.getString(o.attr(s),"");i.valueIndex=t,i.value=this,i.keyValue=r,i.parentKeyValue=d,""==d?e.nothasParentRows.push(i):e.hasParentRows.push(i),e.rows.push(i)}),$.each(this.hasParentRows,function(t){var i=this.parentKeyValue,n=!1;$.each(e.rows,function(){this.keyValue==i&&(n=!0)}),n||(o.push(this),e.nothasParentRows.push(this))}),$.each(o,function(){var t=e.hasParentRows.indexOf(this);e.hasParentRows.splice(t,1)}),e.rows=new Array;$.each(this.nothasParentRows,function(t){this.level=0,e.rows.push(this),e.pushChildRows(this,0)})}},pushChildRows=function(t,i){var e=t.keyValue,o=this,n=parseInt(i)+1,s=!1,r=new Array,d=new Array,l=new Array;$.each(this.hasParentRows,function(t){if(this&&this.parentKeyValue==e){s=!0,this.level=n,o.rows.push(this),r.push(this);var i=parseInt(o.rows.length-1);d.push(i),l.push(this),o.pushChildRows(this,n)}}),$.each(l,function(){var t=o.hasParentRows.indexOf(this);o.hasParentRows.splice(t,1)}),t.hasChild=s,t.childRow=r,t.childRowIndex=d},treeFunObj={initOptionsTree:re_initOptionsTree,clickFunTree:re_clickFunTree,addOneRowTree:re_addOneRowTree,addOneRowTreeHasChildF:re_addOneRowTreeHasChildF,updateValueAtTree:re_updateValueAtTree,getAllChildRow:getAllChildRow,getChildRowIndex:re_getChildRowIndex,getAllChildRowIndex:getAllChildRowIndex,getAllChildRowFun:getAllChildRowFun,getAllChildRowIndexFun:getAllChildRowIndexFun,expandNode:expandNode,expandNodeByIndex:expandNodeByIndex,re_treeSortRows:re_treeSortRows,pushChildRows:pushChildRows,re_initTree:re_initTree},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},classCallCheck=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},dataSource=function t(i,e){classCallCheck(this,t),this.init(i,e),this.sortRows()},dataSourceProto=dataSource.prototype;Object.assign(dataSourceProto,initFunObj),dataSourceProto.basicSortRows=sortFunObj.re_basicSortRows,dataSourceProto.treeSortRows=treeFunObj.re_treeSortRows,dataSourceProto.pushChildRows=treeFunObj.pushChildRows;var init$1=function init(options,gridComp){var gridOptions=gridComp.options;this.gridGetBoolean=gridComp.getBoolean,this.initDefault();var gridDefault={sortable:gridOptions.sortable,canDrag:gridOptions.canDrag,width:gridOptions.columnWidth};"Date"==options.dataType&&(this.defaults.format="YYYY-MM-DD"),options=this.initTree(options,gridOptions),this.options=$.extend({},this.defaults,gridDefault,options),this.getBooleanOptions();try{"string"==typeof this.options.renderType&&(this.options.renderType=eval(this.options.renderType))}catch(t){}try{"string"==typeof this.options.editType&&(this.options.editType=eval(this.options.editType))}catch(t){}this.options.width=this.options.width,this.firstColumn=!1},initTree=function(t){return t},initDefault=function(){this.defaults={width:"200",sortable:!0,canDrag:!0,fixed:!1,visible:!0,canVisible:!0,sumCol:!1,editable:!0,editFormShow:!0,autoExpand:!1,editType:"text",dataType:"String",format:"YYYY-MM-DD hh:mm:ss",headerLevel:1,hiddenLevel:1,textAlign:"left"}},getBooleanOptions=function(){this.options.sortable=this.gridGetBoolean(this.options.sortable),this.options.canDrag=this.gridGetBoolean(this.options.canDrag),this.options.fixed=this.gridGetBoolean(this.options.fixed),this.options.visible=this.gridGetBoolean(this.options.visible),this.options.canVisible=this.gridGetBoolean(this.options.canVisible),this.options.sumCol=this.gridGetBoolean(this.options.sumCol),this.options.editable=this.gridGetBoolean(this.options.editable),this.options.editFormShow=this.gridGetBoolean(this.options.editFormShow),this.options.autoExpand=this.gridGetBoolean(this.options.autoExpand)},initFunObj$1={init:init$1,initDefault:initDefault,initTree:initTree,getBooleanOptions:getBooleanOptions},column=function t(i,e){classCallCheck(this,t),this.init(i,e)},gridCompColumnProto=column.prototype;Object.assign(gridCompColumnProto,initFunObj$1),gridCompColumnProto.initTree=treeFunObj.re_initTree;var gridBrowser={},userAgent=navigator.userAgent,ua=userAgent.toLowerCase(),s;if((s=ua.match(/msie ([\d.]+)/))&&(gridBrowser.isIE=!0),gridBrowser.isIE){var mode=document.documentMode;null==mode||(8==mode?gridBrowser.isIE8=!0:9==mode?gridBrowser.isIE9=!0:10==mode&&(gridBrowser.isIE10=!0))}(ua.indexOf("Android")>-1||ua.indexOf("android")>-1||ua.indexOf("Adr")>-1||ua.indexOf("adr")>-1)&&(gridBrowser.isAndroid=!0),gridBrowser.isAndroid&&(window.screen.width>=768&&window.screen.width<1024&&(gridBrowser.isAndroidPAD=!0),window.screen.width<=768&&(gridBrowser.isAndroidPhone=!0)),ua.match(/iphone/i)&&(gridBrowser.isIOS=!0,gridBrowser.isIphone=!0),ua.match(/ipad/i)&&(gridBrowser.isIOS=!0,gridBrowser.isIPAD=!0),(gridBrowser.isIphone||gridBrowser.isAndroidPhone)&&(gridBrowser.isMobile=!0);var createDivs=function(){var t="",i="",e="";this.ele.innerHTML="",this.options.width?i+="width:"+this.options.width+";":i+="width:auto;",this.options.height?i+="height:"+this.options.height+";":i+="height:auto;",""!=i&&(t='style="'+i+'"'),gridBrowser.isMobile&&(e="u-grid-mobile");var o='<div id="'+this.options.id+'" data-role="grid" class="u-grid '+e+'" '+t+">";o+="</div>",this.ele.insertAdjacentHTML("afterBegin",o);var o='<div id="'+this.options.id+'_top" class="u-grid-top"></div>';document.body.appendChild($(o)[0]),this.initEventFun(),this.widthChangeFun()},repaintDivs=function(){this.repaintGridDivs(),this.realtimeTableRows=null},createGridDivs=function(){if(!this.createGridFlag){$("#"+this.options.id)[0]&&($("#"+this.options.id)[0].innerHTML="");var t='<div id="'+this.options.id+'_grid" class="u-grid">';t+=this.createHeader(),t+=this.createBeginNoScroll(),t+=this.createContent(),t+=this.createEndNoScroll(),t+="</div>",$("#"+this.options.id)[0]&&$("#"+this.options.id).html(t),$("#"+this.options.id+"_column_menu").remove(),$(document.body).append(this.createColumnMenu()),this.initGridEventFun(),this.headerFirstClassFun(),this.showType="grid",this.afterGridDivsCreate(),this.createGridFlag=!0,this.realtimeTableRows=null}},createBeginNoScroll=function(){return this.createNoScroll("begin")},createEndNoScroll=function(){return this.createNoScroll("end")},createNoScroll=function(t){var i='<div id="'+this.options.id+"_noScroll_"+t+'" class="u-grid-noScroll '+t+'"><div class="u-grid-noScroll-wrap '+t+'" id="'+this.options.id+"_noScroll_"+t+'_wrap">';return(this.options.multiSelect||this.options.showNumCol)&&("begin"==t&&this.options.sumRowFirst&&this.options.sumRowFixed||"end"==t&&!this.options.sumRowFirst&&this.options.sumRowFixed)&&(i+='<div id="'+this.options.id+'_noScroll_left" class="u-grid-noScroll-left" style="width:'+this.leftW+"px;height:"+this.noScrollHeight+'px;">',i+="</div>"),i+=this.createNoScrollTableFixed(t),i+=this.createNoScrollTable(t),i+="</div></div>"},createNoScrollTableFixed=function(t){return this.createNoScrollTable(t,"fixed")},createNoScrollTable=function(t,i){var e,o,n;if("fixed"==i?(e=parseInt(this.leftW),o="absolute;width:"+this.fixedWidth+"px;z-index:11;",n="fixed_"):(e="right"==this.options.fixedFloat?parseInt(this.leftW):parseInt(this.leftW)+parseInt(this.fixedWidth),o="relative;",n="",this.contentMinWidth>0&&(o+="width:"+this.contentMinWidth+"px;")),"fixed"==i&&"right"==this.options.fixedFloat)var s='<table role="grid" id="'+this.options.id+"_noScroll_"+n+t+'_table" style="position:'+o+';right:0px;">';else var s='<table role="grid" id="'+this.options.id+"_noScroll_"+n+t+'_table" style="position:'+o+";left:"+e+'px;">';return s+=this.createColgroup(i),s+='<thead role="rowgroup" id="'+this.options.id+"_noSCroll_"+n+t+'_thead" style="display:none">',s+=this.createThead(i),s+="</thead>",("begin"==t&&this.options.sumRowFirst&&this.options.sumRowFixed||"end"==t&&!this.options.sumRowFirst&&this.options.sumRowFixed)&&(s+='<tbody role="rowgroup" id="'+this.options.id+"_noScroll_"+n+t+'_tbody">',s+=this.createContentRowsSumRow(i),s+="</tbody>"),s+="</table>"},repaintGridDivs=function(){$("#"+this.options.id+"_grid").remove(null,!0),this.showType="",this.wholeWidth=0,this.createGridFlag=!1,this.columnsVisibleFun(),this.widthChangeFun(),this.realtimeTableRows=null},createColumnMenu=function(){return""},createHeader=function(){var t="";this.options.showHeader||(t='style="display:none;"');var i='<div class="u-grid-header" id="'+this.options.id+'_header" '+t+'><div class="u-grid-header-wrap" id="'+this.options.id+'_header_wrap" data-role="resizable" >';return this.options.columnMenu&&(i+='<div class="u-grid-header-columnmenu uf uf-navmenu-light"></div>'),(this.options.multiSelect||this.options.showNumCol)&&(i+='<div id="'+this.options.id+'_header_left" class="u-grid-header-left" style="width:'+this.leftW+'px;">',this.options.multiSelect&&(gridBrowser.isIE8?i+='<div class="u-grid-header-multi-select" style="width:'+this.multiSelectWidth+'px;"><span class="u-grid-checkbox-outline" id="'+this.options.id+'_header_multi_input"><span class="u-grid-checkbox-tick-outline"></span></span></div>':i+='<div class="u-grid-header-multi-select  checkbox check-success" style="width:'+this.multiSelectWidth+'px;"><span class="u-grid-checkbox-outline" id="'+this.options.id+'_header_multi_input"><span class="u-grid-checkbox-tick-outline"></span></span></div>'),this.options.showNumCol&&(i+='<div class="u-grid-header-num" style="width:'+this.numWidth+'px;"></div>'),i+="</div>"),i+=this.createHeaderTableFixed(),i+=this.createHeaderTable(),i+="</div>",i+=this.createHeaderDrag(),i+="</div>"},createHeaderTable=function(t){var i,e,o;if("fixed"==t?(i=parseInt(this.leftW),e="absolute;width:"+this.fixedWidth+"px;z-index:11;background:#F9F9F9;",o="fixed_"):(i="right"==this.options.fixedFloat?parseInt(this.leftW):parseInt(this.leftW)+parseInt(this.fixedWidth),e="relative;",o="",this.contentMinWidth>0&&(e+="width:"+this.contentMinWidth+"px;")),"fixed"==t&&"right"==this.options.fixedFloat)var n='<table role="grid" id="'+this.options.id+"_header_"+o+'table" style="position:'+e+';right:0px;">';else var n='<table role="grid" id="'+this.options.id+"_header_"+o+'table" style="position:'+e+";left:"+i+'px;">';return n+=this.createColgroup(t),n+='<thead role="rowgroup" id="'+this.options.id+"_header_"+o+'thead">',n+=this.createThead(t),n+="</thead></table>"},createHeaderTableFixed=function(){return""},createHeaderDrag=function(){return""},createColgroup=function(t){var i,e=this,o="<colgroup>";return i="fixed"==t?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(i,function(){this.options.visible&&(o+="<col",this.options.autoExpand||(o+=' style="width:'+e.formatWidth(this.options.width)+'"'),o+=">")}),o+="</colgroup>"},createThead=function(t){var i,e=this,o=0,n="",s="";this.options.maxHeaderLevel>1&&(n='style="height:'+(this.headerHeight-1)+'px;"',s=" u-grid-header-level-th ");var r='<tr role="row" '+n+">";return i="fixed"==t?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(i,function(t){var i=o,n="";0==this.options.visible?(i=-1,n='style="display:none;"'):o++,r+='<th role="columnheader" data-filed="'+this.options.field+'" rowspan="1" class="u-grid-header-th '+s+'" '+n+'field="'+this.options.field+'" index="'+t+'" visibleIndex="'+i+'"><div style="position:relative;" class="u-grid-header-div">';var d="";if(this.options.headerColor||e.options.headerHeight){var l="",a="";this.options.headerColor&&(l="color:"+this.options.headerColor+";"),e.options.headerHeight&&(a="height:"+e.options.headerHeight+"px;line-height:"+e.options.headerHeight+"px;"),d='style="'+l+a+'"'}var h="";this.options.required&&(h='<span style="color:red;">*</span>'),r+='<div class="u-grid-header-link" field="'+this.options.field+'"  '+d+">"+this.options.title+h+"</div>",r+="</div></th>"}),r+="</tr>"},createContent=function(){var t="",i="",e="";if(this.countContentHeight){var o=$("#"+this.options.id)[0].offsetHeight;this.wholeHeight=o,o>0&&(this.contentHeight=parseInt(o)-this.exceptContentHeight-1>0?parseInt(o)-this.exceptContentHeight-1:0,this.contentHeight>0&&(t='style="height:'+this.contentHeight+'px;"'))}var n='<div id="'+this.options.id+'_content" class="u-grid-content" '+t+">";return(this.options.showNumCol||this.options.multiSelect)&&(n+=this.createContentLeft(),this.contentWidth>this.contentMinWidth||(i="display:none;",e="bottom:0px;"),n+=this.createContentSumRow(e),u.isIOS&&(i+="width:0px;"),"right"==this.options.fixedFloat?this.leftW:this.leftW+this.fixedWidth),n+=this.createContentTableFixed(),n+=this.createContentTable(),n+="</div>"},createContentSumRow=function(){return""},createContentLeft=function(){var t=this,i="",e=0,o="",n="";return this.options.showSumRow&&this.options.sumRowFirst&&!this.options.sumRowFixed&&this.options.sumRowHeight&&(n="top:"+this.options.sumRowHeight+"px"),this.options.showSumRow&&(o="u-grid-content-left-sum",this.options.sumRowFirst&&!this.options.sumRowFixed&&this.dataSourceObj.rows.length>0&&(o+=" u-grid-content-left-sum-first")),this.options.multiSelect&&(i+='<div class="u-grid-content-left u-grid-content-left-multi '+o+'" id="'+this.options.id+'_content_multiSelect" style="width:'+this.multiSelectWidth+"px;"+n+'">',this.dataSourceObj.rows&&(this.options.groupSumRow?i+=t.createContentLeftMultiSelectGroupRows():$.each(this.dataSourceObj.rows,function(e){i+=t.createContentLeftMultiSelectRow(this)})),i+="</div>",e+=this.multiSelectWidth),this.options.showNumCol&&(i+='<div class="u-grid-content-left u-grid-content-left-num '+o+'" id="'+this.options.id+'_content_numCol" style="width:'+this.numWidth+"px;left:"+e+"px;"+n+'">',this.dataSourceObj.rows&&(this.options.groupSumRow?i+=t.createContentLeftNumColGroupRows():$.each(this.dataSourceObj.rows,function(e,o){i+=t.createContentLeftNumColRow(e,o.value)})),i+="</div>"),i},createContentLeftMultiSelectGroupRows=function(){return"<div>参数设置显示分组合计行，但是未引入分组合计行资源</div>"},createContentLeftNumColGroupRows=function(){return"<div>参数设置显示分组合计行，但是未引入分组合计行资源</div>"},createContentLeftMultiSelectRow=function(t,i){var e="";!this.options.autoExpand&&t.level>0&&"block"!=i&&(e="display:none;");var o=t.value["$_#_@_id"];o||(o=setTimeout(function(){}));var n=t.value,s=this.selectRows,r=objCompare(n,s),d="";if(this.options.needResetHeight||(d="height:"+(this.options.rowHeight+1)+"px;"),gridBrowser.isIE8)var l='<div style="width:'+this.multiSelectWidth+"px;"+d+e+'" class="u-grid-content-multiSelect " ><span class="u-grid-checkbox-outline" id="checkbox'+o+'" value="1"><span class="u-grid-checkbox-tick-outline"></span></span></div>';else if(r)var l='<div style="width:'+this.multiSelectWidth+"px;"+d+e+'" class="u-grid-content-multiSelect checkbox check-success u-grid-content-sel-row" ><span class="u-grid-checkbox-outline  is-checked" id="checkbox'+o+'" value="1"><span class="u-grid-checkbox-tick-outline"></span></span></div>';else var l='<div style="width:'+this.multiSelectWidth+"px;"+d+e+'" class="u-grid-content-multiSelect checkbox check-success" ><span class="u-grid-checkbox-outline" id="checkbox'+o+'" value="1"><span class="u-grid-checkbox-tick-outline"></span></span></div>';return l},createContentLeftNumColRow=function(t){var i=this.dataSourceObj.rows[t],e=i.value,o=this.selectRows,n=objCompare(e,o),s="";return this.options.needResetHeight||(s="height:"+(this.options.rowHeight+1)+"px;"),n?'<div style="width:'+this.numWidth+"px;"+s+'" class="u-grid-content-num  u-grid-content-sel-row">'+(t+1)+"</div>":'<div style="width:'+this.numWidth+"px;"+s+'" class="u-grid-content-num">'+(t+1)+"</div>"},createContentTable=function(t){var i,e,o,n,s,r;n=this.countContentHeight&&parseInt(this.contentHeight)>0?"height:"+this.contentHeight+"px;":"","fixed"==t?(i=parseInt(this.leftW),e="fixed_",s="fixed-",o="right"==this.options.fixedFloat?'style="position:absolute;width:'+this.fixedWidth+"px;right:0px;"+n+'"':'style="position:absolute;width:'+this.fixedWidth+"px;left:"+i+"px;"+n+'"',r='style="width:'+this.fixedWidth+'px;"'):(i="right"==this.options.fixedFloat?parseInt(this.leftW):parseInt(this.leftW)+parseInt(this.fixedWidth,0),e="",s="",o='style="position:relative;left:'+i+"px;"+n,this.contentMinWidth>0&&(o+="width:"+this.contentMinWidth+"px;"),this.options.noScroll&&(o+="overflow-x:hidden;"),o+='"',r="",this.contentMinWidth>0&&(r=this.contentWidth>0?'style="min-width:'+this.contentMinWidth+"px;width:"+this.contentWidth+'px;"':'style="min-width:'+this.contentMinWidth+'px;"'));var d='<div id="'+this.options.id+"_content_"+e+'div" class="u-grid-content-'+s+'div" '+o+">";return d+='<div style="height:30px;position:absolute;top:-30px;width:100%;z-index:-1;"></div><table role="grid" id="'+this.options.id+"_content_"+e+'table" '+r+">",d+=this.createColgroup(t),d+='<thead role="rowgroup" id="'+this.options.id+"_content_"+e+'thead" style="display:none">',d+=this.createThead(t),d+="</thead>",d+=this.createContentRows(t),d+="</table>","fixed"!=t&&(d+=this.createNoRowsDiv()),d+="</div>"},createContentTableFixed=function(){return""},createNoRowsDiv=function(){var t="",i="";this.contentMinWidth>0&&(t+='style="width:'+this.contentMinWidth+'px;"'),this.contentWidth>0&&(i+='style="width:'+this.contentWidth+'px;"');var e='<div class="u-grid-noRowsDiv"'+i+' id="'+this.options.id+'_noRows"></div>';return e+='<div class="u-grid-noRowsShowDiv"'+t+' id="'+this.options.id+'_noRowsShow">'+this.transMap.ml_no_rows+"</div>"},createContentRows=function(t){var i,e=this,o="";return i="fixed"==t?"fixed_":"",this.dataSourceObj.rows&&(o+='<tbody role="rowgroup" id="'+this.options.id+"_content_"+i+'tbody">',this.options.sumRowFirst&&!this.options.sumRowFixed&&(o+=this.createContentRowsSumRow(t)),this.options.groupField?o+=e.createContentGroupRows(t):$.each(this.dataSourceObj.rows,function(i){o+=e.createContentOneRow(this,t)}),this.options.sumRowFirst||this.options.sumRowFixed||(o+=this.createContentRowsSumRow(t)),o+="</tbody>"),o},createContentRowsSumRow=function(){return"<div>参数设置显示合计行，但是未引入合计行资源</div>"},createContentGroupRows=function(){return"<div>参数设置显示分组合计行，但是未引入分组合计行资源</div>"},createContentOneRow=function(t,i,e){var o="";!this.options.autoExpand&&t.level>0&&"block"!=e&&(o='style="display:none"');var n=t.value,s=this.selectRows,r=objCompare(n,s),d="",l="";return this.options.showTree&&(t.hasChild?l+=" u-grid-content-parent-row ":l+=" u-grid-content-leaf-row ",0==t.level?l+=" u-grid-content-level0-row ":l+=" u-grid-content-levelother-row "),r&&(l+="u-grid-content-sel-row"),d='<tr role="row" class="'+l+'" '+o+">",d+=this.createContentOneRowTd(t,i),d+="</tr>"},createContentOneRowForIE=function(t,i,e,o,n){var s=t.insertRow(i+1);s.setAttribute("role","row"),!this.options.autoExpand&&e.level>0&&"block"!=n&&(s.style.display="none"),this.options.showTree&&(s.hasChild?$(s).addClass("u-grid-content-parent-row"):$(s).addClass("u-grid-content-leaf-row"),0==s.level?$(s).addClass("u-grid-content-level0-row"):$(s).addClass("u-grid-content-levelother-row")),this.createContentOneRowTdForIE(s,e,o)},repaintRow=function(t){var i=$("#"+this.options.id+"_content_tbody").find('tr[role="row"]')[t],e=$("#"+this.options.id+"_content_fixed_tbody").find('tr[role="row"]')[t],o=this.dataSourceObj.rows[t],n=$(i),s=this.getTrIndex(n);if(gridBrowser.isIE8||gridBrowser.isIE9){var r=$("#"+this.options.id+"_content_table")[0],d=$("#"+this.options.id+"_content_fixed_table")[0],l=i.className,a=e.className
;r.deleteRow(t+1),d.deleteRow(t+1);var i=r.insertRow(t+1);u.addClass(i,l);var e=d.insertRow(t+1);u.addClass(e,a),this.createContentOneRowTdForIE(i,o),this.createContentOneRowTdForIE(e,o,"fixed")}else i.innerHTML=this.createContentOneRowTd(o),e&&(e.innerHTML=this.createContentOneRowTd(o,"fixed"));var h={};h.begin=s,h.length=1,this.renderTypeFun(h)},createContentOneRowTd=function(t,i){var e,o=this,n="",s=t.value;return e="fixed"==i?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(e,function(){var i=this.options.field,e=$(s).attr(i);e=o.getString(e,""),"object"==$.type(e)&&(e=e.showValue);var r=(this.options.renderType,""),d="",l="",a="",h="",u="",c=o.options.rowHeight;if(o.options.showTree&&this.firstColumn){var p=parseInt(o.treeLeft)*parseInt(t.level);r='style="position:relative;',t.hasChild||s.isParent?d=o.options.autoExpand&&!s.isParent?'<span class=" uf uf-reduce-s-o u-grid-content-tree-span"></span>':'<span class=" uf uf-add-s-o u-grid-content-tree-span"></span>':p+=16,r+="text-align:"+this.options.textAlign+";",o.options.maxHeight>40&&(r+="max-height:"+o.options.maxHeight+"px;"),r+="left:"+p+'px;"'}else o.options.maxHeight>40?r+='style="text-align:'+this.options.textAlign+";max-height:"+o.options.maxHeight+'px;"':r+='style="text-align:'+this.options.textAlign+';"';this.options.icon&&(l='<span class="'+this.options.icon+'"></span>'),o.options.heightAuto&&(h="height-auto"),o.options.groupField&&i==o.options.groupField&&(u='class="u-grid-content-td-group-field',o.nowGroupValue==e?(u+=" no-text",o.nowGroupIndex++):(o.nowGroupIndex=1,o.nowGroupValue=e,o.nowGroupRow=o.getGroupRowByGroupValue(e),o.nowGroupRowCount=o.nowGroupRow.rows.length),o.nowGroupIndex==o.nowGroupRowCount&&(u+=" group-last"),u+='"',1==o.nowGroupIndex&&(c=o.options.rowHeight*o.nowGroupRowCount)),this.options.visible?o.options.rowHeight&&(a+='style="height:'+o.options.rowHeight+"px;line-height:"+c+'px;"'):(a='style="display:none;',o.options.rowHeight&&(a+="height:"+o.options.rowHeight+"px;line-height:"+c+"px;"),a+='"'),n+='<td role="rowcell"  '+a+u+' realValue="'+e+'" ><div class="u-grid-content-td-div '+h+'" '+r+">"+d+l+"<span>"+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</span></div></td>"}),n},createContentOneRowTdForIE=function(t,i,e){var o,n=this,s=i.value;o="fixed"==e?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(o,function(){var i=this.options.field,e=$(s).attr(i),e=n.getString(e,"");"object"==$.type(e)&&(e=e.showValue);var o=(this.options.renderType,""),r="",d="",l="",a=t.insertCell(),h="";if(a.setAttribute("role","rowcell"),n.options.showTree&&this.firstColumn){var u=parseInt(n.treeLeft)*parseInt(t.level);o='style="position:relative;',t.hasChild||s.isParent?r=n.options.autoExpand&&!s.isParent?'<span class=" uf uf-reduce-s-o u-grid-content-tree-span"></span>':'<span class=" uf uf-add-s-o u-grid-content-tree-span"></span>':u+=16,o+="text-align:"+this.options.textAlign+";",n.options.maxHeight>40&&(o+="max-height:"+n.options.maxHeight+"px;"),o+="left:"+u+'px;"'}else n.options.maxHeight>40?o+='style="text-align:'+this.options.textAlign+";max-height:"+n.options.maxHeight+'px;"':o+='style="text-align:'+this.options.textAlign+';"';this.options.visible||(a.style.display="none"),n.options.rowHeight&&(a.style.height=n.options.rowHeight+"px",a.style.lineHeight=n.options.rowHeight+"px"),this.options.icon&&(d='<span class="'+this.options.icon+'"></span>'),n.options.heightAuto&&(h="height-auto"),l+='<div class="u-grid-content-td-div '+h+'" '+o+">"+r+d+"<span>"+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</span></div>",a.insertAdjacentHTML("afterBegin",l)})},repairContent=function(){var t=$("#"+this.options.id+"_content").parent();if($("#"+this.options.id+"_content").remove(null,!0),t[0]){var i=this.createContent();t[0].insertAdjacentHTML("beforeEnd",i),this.renderTypeFun(),this.initContentDivEventFun(),$("#"+this.options.id+"_content_div")[0]&&($("#"+this.options.id+"_content_div")[0].scrollLeft=this.scrollLeft),$("#"+this.options.id+"_content_edit_menu").css("display","none")}this.realtimeTableRows=null},objCompare=function(t,i){for(var e=i.length,o=0,n=0;n<e;n++){o+=t==i[n]?1:0}return o>0},createFunObj={createDivs:createDivs,repaintDivs:repaintDivs,createGridDivs:createGridDivs,repaintGridDivs:repaintGridDivs,createColumnMenu:createColumnMenu,createHeader:createHeader,createHeaderTable:createHeaderTable,createHeaderTableFixed:createHeaderTableFixed,createHeaderDrag:createHeaderDrag,createColgroup:createColgroup,createThead:createThead,createContent:createContent,createContentSumRow:createContentSumRow,createContentLeft:createContentLeft,createContentLeftMultiSelectRow:createContentLeftMultiSelectRow,createContentLeftNumColRow:createContentLeftNumColRow,createContentLeftMultiSelectGroupRows:createContentLeftMultiSelectGroupRows,createContentLeftNumColGroupRows:createContentLeftNumColGroupRows,createContentTable:createContentTable,createContentTableFixed:createContentTableFixed,createNoRowsDiv:createNoRowsDiv,createContentRows:createContentRows,createContentRowsSumRow:createContentRowsSumRow,createContentGroupRows:createContentGroupRows,createContentOneRow:createContentOneRow,createContentOneRowForIE:createContentOneRowForIE,repaintRow:repaintRow,createContentOneRowTd:createContentOneRowTd,createContentOneRowTdForIE:createContentOneRowTdForIE,repairContent:repairContent,createBeginNoScroll:createBeginNoScroll,createEndNoScroll:createEndNoScroll,createNoScroll:createNoScroll,createNoScrollTableFixed:createNoScrollTableFixed,createNoScrollTable:createNoScrollTable},trHoverFun=function(t){if(!(t<0)){var i=this;if($("#"+i.options.id+"_content_tbody").find('tr[role="row"]').removeClass("u-grid-move-bg"),$("#"+i.options.id+"_content_fixed_tbody").find('tr[role="row"]').removeClass("u-grid-move-bg"),i.options.multiSelect&&$("#"+i.options.id+"_content_multiSelect").find("div").removeClass("u-grid-move-bg"),i.options.showNumCol&&$("#"+i.options.id+"_content_numCol").find("div").removeClass("u-grid-move-bg"),t>-1){var e=$("#"+i.options.id+"_content_tbody").find('tr[role="row"]').eq(t);if(e&&e[0]&&e[0].id&&e[0].id==i.options.id+"_edit_tr")return;if($("#"+i.options.id+"_content_tbody").find('tr[role="row"]').eq(t).addClass("u-grid-move-bg"),$("#"+i.options.id+"_content_fixed_tbody").find('tr[role="row"]').eq(t).addClass("u-grid-move-bg"),i.options.multiSelect&&$("#"+i.options.id+"_content_multiSelect").find("div").eq(t).addClass("u-grid-move-bg"),i.options.showNumCol&&$("#"+i.options.id+"_content_numCol").find("div").eq(t).addClass("u-grid-move-bg"),"function"==typeof i.options.onRowHover&&!e.is(".u-grid-content-sum-row")){var o={};o.gridObj=i,o.rowObj=i.dataSourceObj.rows[t],o.rowIndex=t,i.options.onRowHover(o)}}}},setIntervalFun=function(t){this.widthChangeFun(),this.heightChangeFun(),this.editorRowChangeFun()},editorRowChangeFun=function(){},afterGridDivsCreate=function(){"grid"==this.showType&&(this.columnsVisibleFun(),this.resetThVariable(),this.countRowHeight(),this.noRowsShowFun(),this.renderTypeFun(),this.resetScrollLeft(),this.hideEditMenu(),this.resetLeftHeight(),this.isCheckedHeaderRow(),this.resetColumnWidthByRealWidth(),"function"==typeof this.options.afterCreate&&this.options.afterCreate.call(this))},countRowHeight=function(){$("#"+this.options.id+"_content_tbody tr")[0]&&(this.rowHeight=$("#"+this.options.id+"_content_tbody tr")[0].offsetHeight)},resetLeftHeight=function(){if(this.options.needResetHeight){this.resetLeftHeightTimes=0;var t=this;this.resetLeftHeightSetTimeout&&clearTimeout(this.resetLeftHeightSetTimeout),this.resetLeftHeightSetTimeout=setTimeout(function(){resetLeftHeightFun.call(t)},100)}},resetLeftHeightFun=function t(){if(this.options.showNumCol||this.options.multiSelect)for(var i=this,e=$("#"+this.options.id+'_content_tbody tr[role="row"]'),o=$("#"+this.options.id+"_content_numCol div"),n=$("#"+this.options.id+"_content_multiSelect > div"),s=0;s<e.length;s++){var r=e[s].offsetHeight;0==r&&this.resetLeftHeightTimes<50&&(this.resetLeftHeightTimes++,this.resetLeftHeightSetTimeout=setTimeout(function(){t.call(i)},100)),o[s]&&(o[s].style.height=r+"px",o[s].style.lineHeight=r+"px"),n[s]&&(n[s].style.height=r+"px",n[s].style.lineHeight=r+"px",$(n[s]).find(".u-grid-checkbox-outline").css("top",(r-14)/2))}this.resetLeftHeightGroupSumFun()},resetLeftHeightGroupSumFun=function(){},noRowsShowFun=function(){this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0?($("#"+this.options.id+"_noRowsShow").css("display","none"),$("#"+this.options.id+"_noRows").css("display","none")):($("#"+this.options.id+"_noRowsShow").css("display","block"),$("#"+this.options.id+"_noRows").css("display","block"))},afterRepaintGrid=function(){this.resetScrollLeft(),this.hideEditMenu()},resetScrollLeft=function(){if($("#"+this.options.id+"_content_div")[0])try{$("#"+this.options.id+"_content_div")[0].scrollLeft=this.scrollLeft}catch(t){}},hideEditMenu=function(){},createCalFunOjb={trHoverFun:trHoverFun,setIntervalFun:setIntervalFun,editorRowChangeFun:editorRowChangeFun,afterGridDivsCreate:afterGridDivsCreate,countRowHeight:countRowHeight,noRowsShowFun:noRowsShowFun,afterRepaintGrid:afterRepaintGrid,resetScrollLeft:resetScrollLeft,hideEditMenu:hideEditMenu,resetLeftHeight:resetLeftHeight,resetLeftHeightGroupSumFun:resetLeftHeightGroupSumFun},initEventFun=function(){var t=this;$("#"+this.options.id).on("mousedown",function(i){$(i.target).closest("#"+t.options.id+"_header").length>0?(t.mouseDownX=i.clientX,t.mouseDownY=i.clientY):$(i.target).closest("#"+t.options.id+"_content").length})},initGridEventFun=function(){var t=this;this.initContentDivEventFun(),$("#"+this.options.id+"_header_multi_input").on("click",function(i){t.hasChecked?t.setAllRowUnSelect():t.setAllRowSelect()})},initContentDivEventFun=function(){var t=this;$("#"+t.options.id+"_content .u-grid-content-left").on("click",function(i){var e=$(i.target).closest(".u-grid-checkbox-outline");if(e.length>0){var o=$(e.parent()),n=$(".u-grid-content-multiSelect",o.parent()).index(o);e.hasClass("is-checked")?t.setRowUnselect(n):t.setRowSelect(n)}}),$("#"+this.options.id+"_content_div").on("scroll",function(i){var e,o=0;t.scrollLeft=this.scrollLeft,t.scrollTop=this.scrollTop,e="right"==t.options.fixedFloat?t.leftW-t.scrollLeft:t.leftW-t.scrollLeft+t.fixedWidth,$("#"+t.options.id+"_header_table").css("left",e+"px"),$("#"+t.options.id+"_noScroll_begin_table").css("left",e+"px"),$("#"+t.options.id+"_noScroll_end_table").css("left",e+"px"),$("#"+t.options.id+"_noRowsShow").css("left",t.scrollLeft+"px"),$("#"+t.options.id+"_edit_form").css("left",t.scrollLeft+"px"),t.options.showSumRow&&t.options.sumRowFirst&&!t.options.sumRowFixed&&(o=44,t.options.sumRowHeight&&(o=t.options.sumRowHeight)),$("#"+t.options.id+"_content_multiSelect").css("top",-t.scrollTop+o+"px"),$("#"+t.options.id+"_content_numCol").css("top",-t.scrollTop+o+"px"),$("#"+t.options.id+"_content_fixed_div").css("top",-t.scrollTop+"px"),gridBrowser.isIE10||gridBrowser.isIPAD||t.editClose()}),$("#"+this.options.id+"_content_tbody").on("click",function(i){"function"==typeof t.options.onDblClickFun?t.isDblEvent("tbodyClick",t.dblClickFun,i,t.clickFun,i):t.clickFun(i)}),$("#"+this.options.id+"_content_fixed_tbody").on("click",function(i){"function"==typeof t.options.onDblClickFun?t.isDblEvent("tbodyClick",t.dblClickFun,i,t.clickFun,i):t.clickFun(i)}),$("#"+this.options.id+"_content").on("mousemove",function(i){var e=$(i.target).closest("tr"),o=$(i.target).closest("div"),n=-1;e.length>0?n=$('tr[role="row"]',e.parent()).index(e):o.length>0&&(o.hasClass("u-grid-content-multiSelect")||o.hasClass("u-grid-content-num"))&&(n=$("div",o.parent()).index(o)),t.trHoverFun(n)}),$("#"+this.options.id+"_content").on("mouseout",function(i){if($("#"+t.options.id+"_content_tbody").find("tr").removeClass("u-grid-move-bg"),$("#"+t.options.id+"_content_fixed_tbody").find("tr").removeClass("u-grid-move-bg"),t.options.multiSelect&&$("#"+t.options.id+"_content_multiSelect").find("div").removeClass("u-grid-move-bg"),t.options.showNumCol&&$("#"+t.options.id+"_content_numCol").find("div").removeClass("u-grid-move-bg"),"function"==typeof t.options.onContentOut){var e={};e.gridObj=t;var o=$(i.target).closest("tr");if(o.length>0&&!o.is(".u-grid-content-sum-row")){var n=$('tr[role="row"]',o.parent()).index(o);e.rowObj=t.dataSourceObj.rows[n],e.rowIndex=n}t.options.onContentOut(e)}})},eventFunObj={initEventFun:initEventFun,initGridEventFun:initGridEventFun,initContentDivEventFun:initContentDivEventFun},getColumnAttr=function(t,i){for(var e=0;e<this.gridCompColumnArr.length;e++)if(this.gridCompColumnArr[e].options.field==i)return $(this.gridCompColumnArr[e].options).attr(t);for(var e=0;e<this.gridCompColumnFixedArr.length;e++)if(this.gridCompColumnFixedArr[e].options.field==i)return $(this.gridCompColumnFixedArr[e].options).attr(t);return""},getColumnByField=function(t){for(var i=0;i<this.gridCompColumnArr.length;i++)if(this.gridCompColumnArr[i].options.field==t)return this.gridCompColumnArr[i];for(var i=0;i<this.gridCompColumnFixedArr.length;i++)if(this.gridCompColumnFixedArr[i].options.field==t)return this.gridCompColumnFixedArr[i];return null},getIndexOfColumn=function(t){for(var i=-1,e=0;e<this.gridCompColumnArr.length;e++)if(this.gridCompColumnArr[e]==t){i=e;break}return i},getVisibleIndexOfColumn=function(t){for(var i=-1,e=0,o=0;o<this.gridCompColumnArr.length;o++){if(this.gridCompColumnArr[o]==t){"none"!=$("#"+this.options.id+"_header").find("th").eq(o).css("display")&&(i=e);break}"none"!=$("#"+this.options.id+"_header").find("th").eq(o).css("display")&&e++}return i},getNextVisibleInidexOfColumn=function(t){for(var i=-1,e=!1,o=0,n=0;n<this.gridCompColumnArr.length;n++){if(this.gridCompColumnArr[n]==t&&("none"!=$("#"+this.options.id+"_header").find("th").eq(n).css("display")&&o++,e=!0),1==e&&"none"!=$("#"+this.options.id+"_header").find("th").eq(n).css("display")){i=o;break}"none"!=$("#"+this.options.id+"_header").find("th").eq(n).css("display")&&o++}return i},getSelectRows=function(){return this.selectRows},getSelectRowsIndex=function(){return this.selectRowsIndex},getFocusRow=function(){return this.focusRow},getFocusRowIndex=function(){return this.focusRowIndex},getAllRows=function(){var t=this;return this.allRows=new Array,this.dataSourceObj.rows&&$.each(this.dataSourceObj.rows,function(){t.allRows.push(this.value)}),this.allRows},getRowByIndex=function(t){return this.dataSourceObj.rows[t]},getRowIndexByValue=function(t,i){var e=-1;return $.each(this.dataSourceObj.rows,function(o){this.value[t]==i&&(e=o)}),e},getChildRowIndex=function(t){var i=[];return $.each(t.childRow,function(){i.push(this.valueIndex)}),i},getColumnByVisibleIndex=function(t){for(var i=-1,e=0;e<this.gridCompColumnArr.length;e++){var o=this.gridCompColumnArr[e];if("none"!=$("#"+this.options.id+"_header").find("th").eq(e).css("display")&&i++,i==t)return o}return null},getAllVisibleColumns=function(){for(var t=[],i=0;i<this.gridCompColumnArr.length;i++)"none"!=$("#"+this.options.id+"_header").find("th").eq(i).css("display")&&t.push(this.gridCompColumnArr[i]);return t},getFunObj={getColumnAttr:getColumnAttr,getColumnByField:getColumnByField,getIndexOfColumn:getIndexOfColumn,getVisibleIndexOfColumn:getVisibleIndexOfColumn,getNextVisibleInidexOfColumn:getNextVisibleInidexOfColumn,getSelectRows:getSelectRows,getSelectRowsIndex:getSelectRowsIndex,getFocusRow:getFocusRow,getFocusRowIndex:getFocusRowIndex,getAllRows:getAllRows,getRowByIndex:getRowByIndex,getRowIndexByValue:getRowIndexByValue,getChildRowIndex:getChildRowIndex,getColumnByVisibleIndex:getColumnByVisibleIndex,getAllVisibleColumns:getAllVisibleColumns},init$2=function(t,i){this.dataSource=dataSource,this.gridCompColumn=column,this.ele=t[0],this.$ele=t,this.initDefault(),this.options=$.extend({},this.defaults,i),this.getBooleanOptions(),this.transDefault={ml_show_column:"显示/隐藏列",ml_clear_set:"清除设置",ml_no_rows:"无数据",ml_sum:"合计:",ml_group_sum:"小计:",ml_close:"关闭"},this.transMap=$.extend({},this.transDefault,i.transMap),this.gridCompColumnFixedArr=new Array,this.gridCompColumnArr=new Array,this.countContentHeight=!0,this.minColumnWidth=80,this.scrollBarHeight=16,this.numWidth=this.options.numWidth||40,this.multiSelectWidth=this.options.multiSelectWidth||40,this.basicGridCompColumnArr=new Array,this.columnMenuWidth=160,this.columnMenuHeight=33,this.gridCompColumnFixedArr=new Array,this.gridCompLevelColumn=new Array,this.baseHeaderHeight=this.options.headerHeight||44,this.headerHeight=this.baseHeaderHeight*parseInt(this.options.maxHeaderLevel)+1,this.gridCompHiddenLevelColumnArr=new Array,this.treeLeft=10,this.overWidthVisibleColumnArr=new Array},getBooleanOptions$1=function(){this.options.cancelFocus=this.getBoolean(this.options.cancelFocus),this.options.showHeader=this.getBoolean(this.options.showHeader),this.options.showNumCol=this.getBoolean(this.options.showNumCol),this.options.multiSelect=this.getBoolean(this.options.multiSelect),this.options.columnMenu=this.getBoolean(this.options.columnMenu),this.options.canDrag=this.getBoolean(this.options.canDrag),this.options.overWidthHiddenColumn=this.getBoolean(this.options.overWidthHiddenColumn),this.options.sortable=this.getBoolean(this.options.sortable),this.options.showSumRow=this.getBoolean(this.options.showSumRow),this.options.sumRowFirst=this.getBoolean(this.options.sumRowFirst),this.options.canSwap=this.getBoolean(this.options.canSwap),this.options.showTree=this.getBoolean(this.options.showTree),this.options.autoExpand=this.getBoolean(this.options.autoExpand),this.options.needTreeSort=this.getBoolean(this.options.needTreeSort),this.options.needLocalStorage=this.getBoolean(this.options.needLocalStorage),this.options.noScroll=this.getBoolean(this.options.noScroll),this.options.cancelSelect=this.getBoolean(this.options.cancelSelect),this.options.contentSelect=this.getBoolean(this.options.contentSelect),this.options.contentFocus=this.getBoolean(this.options.contentFocus),this.options.needResetHeight=this.getBoolean(this.options.needResetHeight),this.options.treeAsync=this.getBoolean(this.options.treeAsync),this.options.heightAuto=this.getBoolean(this.options.heightAuto)},initDefault$1=function(){this.defaults={id:(new Date).valueOf(),editType:"default",cancelFocus:!0,cancelSelect:!0,showHeader:!0,showNumCol:!1,multiSelect:!1,columnMenu:!0,canDrag:!0,formMaxWidth:0,maxHeaderLevel:1,overWidthHiddenColumn:!1,sortable:!0,showSumRow:!1,sumRowFirst:!1,sumRowFixed:!1,canSwap:!0,showTree:!1,autoExpand:!0,needTreeSort:!1,needLocalStorage:!1,noScroll:!1,contentSelect:!0,showEditIcon:!1,contentFocus:!0,fixedFloat:"left",groupField:"",groupSumRow:!1,rowHeight:44,columnMenuType:"base",needResetHeight:!1,treeAsync:!1,heightAuto:!1,expandColumnIndex:0}},initGrid=function(){if(this.options.columns&&0!=this.options.columns.length){var t=this;this.initOptions(),this.initVariable(),this.initWidthVariable(),this.initGridCompColumn(),this.initDataSource(),this.createDivs(),this.inte=setInterval(function(){t.setIntervalFun.call(t)},300)}},destroySelf=function(){clearInterval(this.inte),this.$ele.data("gridComp",null),this.ele.innerHTML="",this.showTree="",this.showType=""},initOptions=function(){this.options.width=this.formatWidth(this.options.width),this.options.height=this.formatWidth(this.options.height),this.options.rowHeight=parseInt(this.options.rowHeight),"100%"!=this.options.height&&this.options.height||(this.countContentHeight=!1),this.initOptionsTree(),this.leftW=0,this.options.showNumCol&&(this.leftW+=this.numWidth),this.options.multiSelect&&(this.leftW+=this.multiSelectWidth),this.exceptContentHeight=0,this.noScrollHeight=0,this.options.showHeader&&(this.exceptContentHeight+=this.headerHeight),this.fixedWidth=0,this.options.maxHeaderLevel>1&&(this.options.canSwap=!1,this.options.canDrag=!1,this.options.columnMenu=!1),this.options.rowHeight&&!this.options.sumRowHeight&&(this.options.sumRowHeight=this.options.rowHeight),this.options.sumRowFixed&&(this.noScrollHeight+=this.options.sumRowHeight,this.exceptContentHeight+=this.options.sumRowHeight,this.exceptContentHeight+=1),this.options.heightAuto?this.options.needResetHeight=!0:this.options.maxHeight=0;var t=window.location.href,i=t.indexOf("?");i>0&&(t=t.substring(0,i)),this.localStorageId=this.options.id+t},initOptionsTree=function(){},initVariable=function(){this.initDataSourceVariable(),this.mouseUpX="mouseUpX",this.mouseUpY="mouseUpY",this.mouseDownX="mouseDownX",this.mouseDownY="mouseDownY",this.mouseMoveX="mouseMoveX",this.mouseMoveY="mouseMoveY",this.scrollLeft=0,this.scrollTop=0,this.showType="",this.createGridFlag=!1,this.columnClickX=0,this.columnClickY=0,this.columnMenuMove=!1,this.firstColumn=!0,this.lastVisibleColumn=null,this.lastVisibleColumnWidth=0,this.columnMenuMove=!1,this.createColumnMenuFlag=!1,this.menuColumnsHeight=0,this.createFormFlag=!1,this.$sd_storageData=null},initDataSourceVariable=function(){this.selectRows=new Array,this.selectRowsObj=new Array,this.selectRowsIndex=new Array,this.allRows=new Array,this.eidtRowIndex=-1},initWidthVariable=function(){this.wholeWidth=0,this.wholeHeight=0,this.rowHeight=0,this.contentRealWidth=0,this.contentWidth=0,this.contentMinWidth=0,this.contentHeight=0,this.fixedRealWidth=0,this.fixedWidth=0},initGridCompColumn=function(){var t=this;this.initGridCompColumnVar(),this.options.columns&&$.each(this.options.columns,function(i){t.initGridCompColumnFun(this)}),this.initGridCompColumnLoacl(),this.initGridHiddenLevelColumn(),this.initGridCompFixedColumn(),this.columnsVisibleFun()},initGridCompColumnVar=function(){this.gridCompColumnArr=new Array,this.basicGridCompColumnArr=new Array,this.gridCompColumnFixedArr=new Array,this.gridCompLevelColumn=new Array,this.gridCompHiddenLevelColumnArr=new Array},initGridCompColumnFun=function(t){var i=new column(t,this);this.editHeadTitleIcon(i),(i.options.width+"").indexOf("%")>0?this.options.noScroll="true":i.options.width=parseInt(i.options.width),i.options.optionsWidth=i.options.width,i.options.realWidth=i.options.width,this.gridCompColumnArr.push(i),this.initGridCompColumnColumnMenuFun(t),this.initGridCompColumnHeaderLevelFun(t)},initGridCompColumnColumnMenuFun=function(t){},initGridCompColumnHeaderLevelFun=function(t){},initGridCompColumnLoacl=function(t){},initGridHiddenLevelColumn=function(){},initGridCompFixedColumn=function(){},setRequired=function(t,i){},initDataSource=function(){this.dataSourceObj=new dataSource(this.options.dataSource,this)},initFunObj$2={init:init$2,getBooleanOptions:getBooleanOptions$1,initDefault:initDefault$1,initGrid:initGrid,destroySelf:destroySelf,initOptions:initOptions,initOptionsTree:initOptionsTree,initVariable:initVariable,initDataSourceVariable:initDataSourceVariable,initWidthVariable:initWidthVariable,initGridCompColumn:initGridCompColumn,initGridCompColumnVar:initGridCompColumnVar,initGridCompColumnFun:initGridCompColumnFun,initGridCompColumnColumnMenuFun:initGridCompColumnColumnMenuFun,initGridCompColumnHeaderLevelFun:initGridCompColumnHeaderLevelFun,initGridCompColumnLoacl:initGridCompColumnLoacl,initGridHiddenLevelColumn:initGridHiddenLevelColumn,initGridCompFixedColumn:initGridCompFixedColumn,setRequired:setRequired,initDataSource:initDataSource},isCheckedHeaderRow=function(){0!==this.selectRows.length&&this.selectRows.length==this.dataSourceObj.rows.length?($("#"+this.options.id+"_header_multi_input").addClass("is-checked"),this.hasChecked=!0):($("#"+this.options.id+"_header_multi_input").removeClass("is-checked"),this.hasChecked=!1)},addOneRow=function(t,i){if("function"==typeof this.options.filterDataFun){t=this.options.filterDataFun.call(this,[t])[0]}var e="none",o={},n=this.dataSourceObj.rows.length,s=!1;if(o.value=t,this.options.showTree){var r=this.addOneRowTree(t,i,o);i=r.index,e=r.displayFlag}this.options.groupField&&(i=this.getGroupIndex(t,i,o)),0!=i&&(i&&i>0?n<i&&(i=n):i=0),n==i&&(s=!0),o.valueIndex=i,o.value=t,this.dataSourceObj.rows.splice(i,0,o),this.dataSourceObj.rows.length>i+1&&$.each(this.dataSourceObj.rows,function(t){t>i&&(this.valueIndex=this.valueIndex+1)});var n=0;if(this.options.showTree?(this.dataSourceObj.options.values?n=this.dataSourceObj.options.values.length:this.dataSourceObj.options.values=new Array,this.dataSourceObj.options.values.splice(i,0,t),this.addOneRowTreeHasChildF(o)):(this.dataSourceObj.options.values||(this.dataSourceObj.options.values=new Array),this.dataSourceObj.options.values.splice(i,0,t)),"grid"==this.showType&&!this.hasChildF){this.editClose(),this.updateEditRowIndex("+",i);try{var d=this.createContentOneRow(o,"normal",e);if(s)$("#"+this.options.id+"_content_tbody")[0].insertAdjacentHTML("beforeEnd",d);else{var l=$("#"+this.options.id+"_content_tbody").find('tr[role="row"]')[i-1],a=$("#"+this.options.id+"_content_tbody")[0];l?l.insertAdjacentHTML("afterEnd",d):a&&a.insertAdjacentHTML("afterBegin",d)}if($("#"+this.options.id+"_content_fixed_div").length>0){var d=this.createContentOneRow(o,"fixed",e);if(s)$("#"+this.options.id+"_content_fixed_tbody")[0].insertAdjacentHTML("beforeEnd",d);else{var l=$("#"+this.options.id+"_content_fixed_tbody").find('tr[role="row"]')[i-1];l?l.insertAdjacentHTML("afterEnd",d):$("#"+this.options.id+"_content_fixed_tbody")[0]&&$("#"+this.options.id+"_content_fixed_tbody")[0].insertAdjacentHTML("afterBegin",d)}}}catch(t){var h=$("#"+this.options.id+"_content_div table")[0];h&&this.createContentOneRowForIE(h,i,o,"normal",e);var u=$("#"+this.options.id+"_content_fixed_div table")[0];u&&this.createContentOneRowForIE(u,i,o,"fixed",e)}if(this.options.multiSelect){var d=this.createContentLeftMultiSelectRow(o,e);if(s)$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("beforeEnd",d);else{var c=$("#"+this.options.id+"_content_multiSelect").find("div")[i-1];c?c.insertAdjacentHTML("afterEnd",d):$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("afterBegin",d)}this.options.sumRowFirst&&!this.options.sumRowFixed&&this.dataSourceObj.rows.length>0&&$("#"+this.options.id+"_content_multiSelect").addClass("u-grid-content-left-sum-first")}if(this.options.showNumCol){var d=this.createContentLeftNumColRow(i,t);if(s)$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("beforeEnd",d);else{var c=$("#"+this.options.id+"_content_numCol").find("div")[i-1];c?c.insertAdjacentHTML("afterEnd",d):$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("afterBegin",d)}this.options.sumRowFirst&&!this.options.sumRowFixed&&this.dataSourceObj.rows.length>0&&$("#"+this.options.id+"_content_numCol").addClass("u-grid-content-left-sum-first"),this.resetNumCol(),this.updateNumColLastRowFlag()}this.repairSumRow(),this.repairGroupSumRow(o),this.noRowsShowFun(),this.updateLastRowFlag(),this.resetLeftHeight(),this.dataSourceObj.rows.length>0?$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","block"):$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","none");var p={};if(p.begin=i,p.length=1,this.renderTypeFun(p),this.options.groupField){var m=t[this.options.groupField];this.resetGroupFieldTd(m)}}},resetGroupFieldTd=function(){},repairGroupSumRow=function(){},addOneRowTree=function(t,i){return i},getGroupIndex=function(t,i){return i},addOneRowTreeHasChildF=function(){},editClose=function(){},addRows=function(t,i){if(this.$ele.data("gridComp")==this)if(this.options.showTree||this.options.groupField)for(var e=t.length,o=0;o<e;o++)this.addOneRow(t[o],e);else{"function"==typeof this.options.filterDataFun&&(t=this.options.filterDataFun.call(this,t)),this.editClose();var n="",s="",r="",d="",l=this,e=this.dataSourceObj.rows.length,a=!1;0!=i&&(i&&i>0?e<i&&(i=e):i=0),e==i&&(a=!0);var h=new Array;if($.each(t,function(t){var e={};e.value=this,e.valueIndex=i+t,h.push(e),l.dataSourceObj.rows.splice(i+t,0,e),l.updateEditRowIndex("+",i+t)}),this.dataSourceObj.options.values||(this.dataSourceObj.options.values=new Array),$.each(t,function(t){l.dataSourceObj.options.values.splice(i+t,0,this)}),this.dataSourceObj.rows.length>i+t.length&&$.each(this.dataSourceObj.rows,function(e){e>i+t.length-1&&(this.valueIndex=this.valueIndex+t.length)}),"grid"==this.showType&&$("#"+this.options.id+"_content_div tbody")[0]){$.each(h,function(t,i){n+=l.createContentOneRow(this),d+=l.createContentOneRowFixed(this),l.options.multiSelect&&(s+=l.createContentLeftMultiSelectRow(this)),l.options.showNumCol&&(r+=l.createContentLeftNumColRow(e+t,i.value))});try{a?$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("beforeEnd",n):$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]')[i]?$("#"+this.options.id+"_content_div").find("tbody").find('tr[role="row"]')[i].insertAdjacentHTML("beforeBegin",n):$("#"+this.options.id+"_content_div tbody")[0]&&$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("afterBegin",n),a?$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("beforeEnd",d):$("#"+this.options.id+"_content_fixed_div").find("tbody").find('tr[role="row"]')[i]?$("#"+this.options.id+"_content_fixed_div").find("tbody").find('tr[role="row"]')[i].insertAdjacentHTML("beforeBegin",d):$("#"+this.options.id+"_content_fixed_div tbody")[0]&&$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("afterBegin",d)}catch(t){var u=$("#"+this.options.id+"_content_div table")[0],c=$("#"+this.options.id+"_content_fixed_div table")[0];u&&c&&$.each(h,function(t){l.createContentOneRowForIE(u,i+t,this),l.createContentOneRowForIE(c,i+t,this,"fixed")})}if(this.options.multiSelect){if(a)$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("beforeEnd",s);else{var p=$("#"+this.options.id+"_content_multiSelect").find("div")[i];p?p.insertAdjacentHTML("beforeBegin",s):$("#"+this.options.id+"_content_multiSelect")[0].insertAdjacentHTML("afterBegin",s)}this.options.sumRowFirst&&!this.options.sumRowFixed&&this.dataSourceObj.rows.length>0&&$("#"+this.options.id+"_content_multiSelect").addClass("u-grid-content-left-sum-first")}if(this.options.showNumCol){if(a)$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("beforeEnd",r);else{var p=$("#"+this.options.id+"_content_numCol").find("div")[i];p?p.insertAdjacentHTML("beforeBegin",r):$("#"+this.options.id+"_content_numCol")[0].insertAdjacentHTML("afterBegin",r)}this.options.sumRowFirst&&!this.options.sumRowFixed&&this.dataSourceObj.rows.length>0&&$("#"+this.options.id+"_content_numCol").addClass("u-grid-content-left-sum-first"),this.resetNumCol(),this.updateNumColLastRowFlag()}this.repairSumRow(),this.dataSourceObj.rows.length>0?$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","block"):$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","none"),this.noRowsShowFun();var m={};m.begin=i,m.length=t.length,this.renderTypeFun(m)}this.updateLastRowFlag(),this.isCheckedHeaderRow(),this.resetLeftHeight()}},createContentOneRowFixed=function(t){return""},updateEditRowIndex=function(t,i,e){},deleteOneRow=function(t){var i=this;t=parseInt(t);var e=this.dataSourceObj.rows[t];if(e){var o=e.value;if("grid"==this.showType&&this.editClose(),this.dataSourceObj.rows.splice(t,1),this.updateEditRowIndex("-",t),this.dataSourceObj.options.values){var n=this.dataSourceObj.options.values.indexOf(o);this.dataSourceObj.options.values.splice(n,1)}if(this.dataSourceObj.rows.length>t+1&&$.each(this.dataSourceObj.rows,function(i){i>=t&&(this.valueIndex=this.valueIndex-1)}),this.selectRows&&$.each(this.selectRows,function(e){this==o?(i.selectRows.splice(e,1),i.selectRowsObj.splice(e,1),i.selectRowsIndex.splice(e,1)):i.selectRowsIndex[e]>t&&(i.selectRowsIndex[e]=i.selectRowsIndex[e]-1)}),this.focusRow&&(this.focusRow==o?(this.focusRow=null,this.focusRowObj=null,this.focusRowIndex=null):this.focusRowIndex>t&&(this.focusRowIndex=this.focusRowIndex-1)),this.deleteOneRowGroup(e),"grid"==this.showType&&($("#"+this.options.id+'_content_div tbody tr[role="row"]:eq('+t+")").remove(),$("#"+this.options.id+'_content_fixed_div tbody tr[role="row"]:eq('+t+")").remove(),
$("#"+this.options.id+"_content_multiSelect >div:eq("+t+")").remove(),$("#"+this.options.id+"_content_numCol >.u-grid-content-num:eq("+t+")").remove(),0==this.dataSourceObj.rows.length&&($("#"+this.options.id+"_content_multiSelect").removeClass("u-grid-content-left-sum-first"),$("#"+this.options.id+"_content_numCol").removeClass("u-grid-content-left-sum-first")),this.resetNumCol(),this.repairSumRow(),this.repairGroupSumRow(e),this.noRowsShowFun(),this.updateNumColLastRowFlag(),this.dataSourceObj.rows.length>0?$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","block"):$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","none"),this.options.groupField)){var s=e.value[this.options.groupField];this.resetGroupFieldTd(s)}if(this.deleteOneRowTree(),"function"==typeof this.options.onRowDelete){var r={};if(r.gridObj=this,r.index=t,r.row=e,!this.options.onRowDelete(r))return}this.isCheckedHeaderRow()}},repairSumRow=function(){},deleteOneRowGroupSum=function(){},deleteOneRowTree=function(){},deleteRows=function(t){var i=this,e=new Array;$.each(t,function(i){e.push(t[i])}),e.sort(function(t,i){return i-t}),$.each(e,function(t){i.deleteOneRow(this)}),this.isCheckedHeaderRow()},updateRow=function(t,i){if(t>-1&&t<this.dataSourceObj.rows.length&&(this.dataSourceObj.rows[t].value=i,this.dataSourceObj.options.values[this.dataSourceObj.rows[t].valueIndex]=i,"grid"==this.showType)){var e={};e.begin=t,e.length=1,this.renderTypeFun(e),this.repairSumRow()}},updateValueAt=function(t,i,e,o){if(t>-1&&t<this.dataSourceObj.rows.length){var n=$(this.dataSourceObj.rows[t].value).attr(i),s=t;if(void 0===e&&(e=""),n!=e||o){if("function"==typeof this.options.onBeforeValueChange){var r={};r.gridObj=this,r.rowIndex=s,r.field=i,r.oldValue=n,r.newValue=e;if(!this.options.onBeforeValueChange(r))return}if($(this.dataSourceObj.rows[t].value).attr(i,e),"grid"==this.showType){var r={};r.field=i,r.begin=t,r.length=1,this.renderTypeFun(r),s=this.updateValueAtTree(t,i,e,o),this.updateValueAtEdit(t,i,e,o),this.repairSumRow(),this.repairGroupSumRow(this.dataSourceObj.rows[t])}if("function"==typeof this.options.onValueChange){var r={};r.gridObj=this,r.rowIndex=s,r.field=i,r.oldValue=n,r.newValue=e,this.options.onValueChange(r)}this.resetLeftHeight()}}},updateValueAtTree=function(t,i,e,o){return t},updateValueAtEdit=function(t,i,e,o){},setRowSelect=function(t,i){var e,o,n,s;if(!this.dataSourceObj.rows[t])return!0;if("grid"==this.showType&&(o=i&&i.contentTrs?i.contentTrs[t]:this.$ele.find("#"+this.options.id+'_content_tbody tr[role="row"]')[t]),this.dataSourceObj.rows[t].checked){if("grid"!=this.showType)return!0;if(u.hasClass(o,"u-grid-content-sel-row"))return!0}if(e=i&&i.multiSelectDivs?i.multiSelectDivs[t]:this.$ele.find("#"+this.options.id+"_content_multiSelect").find("div")[t],"function"==typeof this.options.onBeforeRowSelected){var r={};if(r.gridObj=this,r.rowObj=this.dataSourceObj.rows[t],r.rowIndex=t,!this.options.onBeforeRowSelected(r)){if(this.options.multiSelect){var d=e.children[0];d.checked=!1}return!1}}if(this.options.multiSelect){if("grid"==this.showType){var d=e.children[0];$(d).addClass("is-checked")}}else this.selectRowsObj&&this.selectRowsObj.length>0&&$.each(this.selectRowsObj,function(){this.checked=!1}),this.selectRows=new Array,this.selectRowsObj=new Array,this.selectRowsIndex=new Array,"grid"==this.showType&&($("#"+this.options.id+'_content_tbody tr[role="row"]').removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_tbody tr[role="row"] a').removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]').removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"] a').removeClass("u-grid-content-sel-row"),this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect div").removeClass("u-grid-content-sel-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol div").removeClass("u-grid-content-sel-row"));if("grid"==this.showType){$(o).addClass("u-grid-content-sel-row"),n=i&&i.fixContentTrs?i.fixContentTrs[t]:this.$ele.find("#"+this.options.id+'_content_fixed_tbody tr[role="row"]')[t],$(n).addClass("u-grid-content-sel-row");var l=t;this.eidtRowIndex>-1&&this.eidtRowIndex<t&&"form"==this.options.editType&&l++,this.options.multiSelect&&(l!=t&&(e=this.$ele.find("#"+this.options.id+"_content_multiSelect").find("div")[l]),$(e).addClass("u-grid-content-sel-row")),this.options.showNumCol&&(s=i&&i.numColDivs?i.numColDivs[l]:this.$ele.find("#"+this.options.id+"_content_numCol").find("div")[l],$(s).addClass("u-grid-content-sel-row"))}if(this.selectRows.push(this.dataSourceObj.rows[t].value),this.selectRowsObj.push(this.dataSourceObj.rows[t]),this.selectRowsIndex.push(t),this.dataSourceObj.rows[t].checked=!0,this.isCheckedHeaderRow(),"function"==typeof this.defaultOnRowSelected){var r={};r.gridObj=this,r.rowObj=this.dataSourceObj.rows[t],r.rowIndex=t,this.defaultOnRowSelected(r)}if("function"==typeof this.options.onRowSelected){var r={};r.gridObj=this,r.rowObj=this.dataSourceObj.rows[t],r.rowIndex=t,this.options.onRowSelected(r)}return!0},setRowUnselect=function(t){var i=this;if(!this.dataSourceObj.rows[t])return!0;if(!this.dataSourceObj.rows[t].checked)return!0;if("function"==typeof this.options.onBeforeRowUnSelected){var e={};if(e.gridObj=this,e.rowObj=this.dataSourceObj.rows[t],e.rowIndex=t,!this.options.onBeforeRowUnSelected(e))return this.options.multiSelect&&($("#"+this.options.id+"_content_multiSelect input:eq("+t+")")[0].checked=!0),!1}this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect .u-grid-checkbox-outline:eq("+t+")").removeClass("is-checked");var o=t;if(this.eidtRowIndex>-1&&this.eidtRowIndex<t&&"form"==this.options.editType&&o++,$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+o+")").removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+o+") a").removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+o+")").removeClass("u-grid-content-sel-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+o+") a").removeClass("u-grid-content-sel-row"),this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect >div:eq("+o+")").removeClass("u-grid-content-sel-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol >div:eq("+o+")").removeClass("u-grid-content-sel-row"),$.each(this.selectRows,function(e){this==i.dataSourceObj.rows[t].value&&(i.selectRows.splice(e,1),i.selectRowsObj.splice(e,1),i.selectRowsIndex.splice(e,1))}),this.dataSourceObj.rows[t].checked=!1,$("#"+this.options.id+"_header_multi_input").removeClass("is-checked"),"function"==typeof this.options.onRowUnSelected){var e={};e.gridObj=this,e.rowObj=this.dataSourceObj.rows[t],e.rowIndex=t,this.options.onRowUnSelected(e)}return i.isCheckedHeaderRow(),!0},setAllRowSelect=function(){if($("#"+this.options.id+"_header_multi_input").addClass("is-checked"),"function"==typeof this.options.onBeforeAllRowSelected){var t={};if(t.gridObj=this,t.rowObjs=this.dataSourceObj.rows,!this.options.onBeforeAllRowSelected(t))return}var i=this.$ele.find("#"+this.options.id+"_content_multiSelect >div"),e=this.$ele.find("#"+this.options.id+"_content_numCol >div"),o=this.$ele.find("#"+this.options.id+'_content_tbody tr[role="row"]'),n=this.$ele.find("#"+this.options.id+'_content_fixed_tbody tr[role="row"]');this.$ele.find("#"+this.options.id+'_content_tbody tr[role="row"]');for(var s=0;s<this.dataSourceObj.rows.length;s++)this.setRowSelect(s,{multiSelectDivs:i,numColDivs:e,contentTrs:o,fixContentTrs:n});if(this.hasChecked=!0,"function"==typeof this.options.onAllRowSelected){var t={};t.gridObj=this,t.rowObjs=this.dataSourceObj.rows,this.options.onAllRowSelected(t)}},setAllRowUnSelect=function(){if($("#"+this.options.id+"_header_multi_input").removeClass("is-checked"),"function"==typeof this.options.onBeforeAllRowUnSelected){var t={};if(t.gridObj=this,t.rowObjs=this.dataSourceObj.rows,!this.options.onBeforeAllRowUnSelected(t))return}for(var i=0;i<this.dataSourceObj.rows.length;i++)this.setRowUnselect(i);if(this.hasChecked=!1,"function"==typeof this.options.onAllRowUnSelected){var t={};t.gridObj=this,t.rowObjs=this.dataSourceObj.rows,this.options.onAllRowUnSelected(t)}},setRowFocus=function(t){if(this.dataSourceObj.rows[t].focus)return!0;if(!this.dataSourceObj.rows[t])return!0;if("function"==typeof this.options.onBeforeRowFocus){var i={};if(i.gridObj=this,i.rowObj=this.dataSourceObj.rows[t],i.rowIndex=t,!this.options.onBeforeRowFocus(i))return!1}$("#"+this.options.id+'_content_tbody tr[role="row"]').removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_tbody tr[role="row"] a').removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]').removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"] a').removeClass("u-grid-content-focus-row"),this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect").find("div").removeClass("u-grid-content-focus-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol").find("div").removeClass("u-grid-content-focus-row"),this.focusRowObj&&(this.focusRowObj.focus=!1),$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+t+")").addClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+t+") a").addClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+t+")").addClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+t+") a").addClass("u-grid-content-focus-row");var e=t;if(this.eidtRowIndex>-1&&this.eidtRowIndex<t&&"form"==this.options.editType&&e++,this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect >div:eq("+e+")").addClass("u-grid-content-focus-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol >div:eq("+e+")").addClass("u-grid-content-focus-row"),this.focusRow=this.dataSourceObj.rows[t].value,this.focusRowObj=this.dataSourceObj.rows[t],this.focusRowIndex=t,this.dataSourceObj.rows[t].focus=!0,"function"==typeof this.options.onRowFocus){var i={};i.gridObj=this,i.rowObj=this.dataSourceObj.rows[t],i.rowIndex=t,this.options.onRowFocus(i)}return!0},setRowUnFocus=function(t){if(!this.dataSourceObj.rows[t])return!0;if("function"==typeof this.options.onBeforeRowUnFocus){var i={};if(i.gridObj=this,i.rowObj=this.dataSourceObj.rows[t],i.rowIndex=t,!this.options.onBeforeRowUnFocus(i))return!1}if(!this.dataSourceObj.rows[t].focus)return!0;var e=t;if(this.eidtRowIndex>-1&&this.eidtRowIndex<t&&"form"==this.options.editType&&e++,$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+e+")").removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+e+") a").removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+e+")").removeClass("u-grid-content-focus-row"),$("#"+this.options.id+'_content_fixed_tbody tr[role="row"]:eq('+e+") a").removeClass("u-grid-content-focus-row"),this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect >div:eq("+e+")").removeClass("u-grid-content-focus-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol >div:eq("+e+")").removeClass("u-grid-content-focus-row"),this.dataSourceObj.rows[t].focus=!1,this.focusRow=null,this.focusRowObj=null,this.focusRowIndex=null,"function"==typeof this.options.onRowUnFocus){var i={};i.gridObj=this,i.rowObj=this.dataSourceObj.rows[t],i.rowIndex=t,this.options.onRowUnFocus(i)}return this.options.multiSelect||this.setRowUnselect(t),!0},resetNumCol=function(){var t=$("#"+this.options.id+"_content_numCol >.u-grid-content-num");$.each(t,function(t){this.innerHTML=t+1+""})},operateRowFunObj={isCheckedHeaderRow:isCheckedHeaderRow,addOneRow:addOneRow,addOneRowTree:addOneRowTree,addOneRowTreeHasChildF:addOneRowTreeHasChildF,getGroupIndex:getGroupIndex,editClose:editClose,addRows:addRows,createContentOneRowFixed:createContentOneRowFixed,updateEditRowIndex:updateEditRowIndex,deleteOneRow:deleteOneRow,repairSumRow:repairSumRow,deleteOneRowTree:deleteOneRowTree,deleteRows:deleteRows,updateRow:updateRow,updateValueAt:updateValueAt,updateValueAtTree:updateValueAtTree,updateValueAtEdit:updateValueAtEdit,setRowSelect:setRowSelect,setRowUnselect:setRowUnselect,setAllRowSelect:setAllRowSelect,setAllRowUnSelect:setAllRowUnSelect,setRowFocus:setRowFocus,setRowUnFocus:setRowUnFocus,resetNumCol:resetNumCol,repairGroupSumRow:repairGroupSumRow,deleteOneRowGroupSum:deleteOneRowGroupSum,resetGroupFieldTd:resetGroupFieldTd},renderTypeFun=function(t){if(this.isGridShow()){if(void 0===t)var i=null,e=null,o="";else var i=void 0===t.begin?null:t.begin,e=void 0===t.length?null:t.length,o=void 0===t.field?"":t.field;var n=this,i=parseInt(i),e=parseInt(e);if(e>0&&parseInt(i+e-1),""==o)this.gridCompColumnFixedArr&&$.each(this.gridCompColumnFixedArr,function(t){n.renderTypeByColumn(this,t,i,e,!0)}),$.each(this.gridCompColumnArr,function(t){n.renderTypeByColumn(this,t,i,e,!1)});else{var s=!1;this.gridCompColumnFixedArr&&$.each(this.gridCompColumnFixedArr,function(t){if(this.options.field==o)return n.renderTypeByColumn(this,t,i,e,!0),void(s=!0)}),s||$.each(this.gridCompColumnArr,function(t){if(this.options.field==o)return void n.renderTypeByColumn(this,t,i,e,!1)})}}},renderTypeByColumn=function(t,i,e,o,n){var s=this,r=t.options.renderType,d=(t.options.sumCol,t.options.sumRenderType,t.options.dataType),l=t.options.precision,a=(t.options.format,t.options.field),h=e,c=!0===n?"_content_fixed_tbody":"_content_tbody",p=this.getVisibleIndexOfColumn(t);o>0&&(h=parseInt(e+o-1)),this.realtimeTableRows=$("#"+this.options.id+c).find('tr[role="row"]');$.each(s.dataSourceObj.rows,function(o){if(e>=0&&o>=e&&o<=h||isNaN(e)){s.editColIndex==p&&s.eidtRowIndex==o&&"default"==s.options.editType&&(s.editColIndex=-1,s.eidtRowIndex=-1);var c=o,m=s.realtimeTableRows[c],f=m.children[i];if(s.iconSpan)var g=s.iconSpan;if(f){if(-1!=f.children[0].innerHTML.indexOf("u-grid-content-tree-span"))var w=f.children[0].children[1];else var w=f.children[0];if(w){var v=$(this.value).attr(a);if("function"==typeof r||"Date"==d||"Datetime"==d||"Int"==d||"Float"==d)if(w.innerHTML="","function"==typeof r){v=s.getString(v,"");var C={};C.value=v,C.element=w,C.gridObj=s,C.row=this,C.gridCompColumn=t,C.rowIndex=o,r.call(s,C)}else if("Date"==d||"Datetime"==d)null!=v&&void 0!=v&&"null"!=v&&"undefined"!=v&&""!=v||(v=""),v="Date"==d?u.dateRender(v):u.dateTimeRender(v),w.innerHTML=v,w.title=v;else if("Int"==d)v=parseInt(v),v?(w.innerHTML=v,w.title=v):(w.innerHTML="",w.title="");else if("Float"==d){if(l){var _={};_.value=v,_.precision=l,v=s.DicimalFormater(_)}else v=parseFloat(v);v?(w.innerHTML=v,w.title=v):(w.innerHTML="",w.title="")}else{v=s.getString(v,"");var b=v.replace(/\</g,"<");b=b.replace(/\>/g,">"),w.title=v,v=v.replace(/\</g,"&lt;"),v=v.replace(/\>/g,"&gt;"),w.innerHTML=v}else{v=s.getString(v,"");var b=v.replace(/\</g,"<");b=b.replace(/\>/g,">"),w.title=v,v=v.replace(/\</g,"&lt;"),v=v.replace(/\>/g,"&gt;"),0==i&&g&&(v=g+=v),w.innerHTML=v}var C={span:w,column:t},R=t.options.maxLength,x=!1;x=R&&R>0?w.innerHTML.length>R:s.getRenderOverFlag(C),x&&$(w).addClass("u-grid-content-td-div-over")}}}s.renderTypeGroupSumRow(t,i,n,this)}),this.renderTypeSumRow(t,i,e,o,n)},getRenderOverFlag=function(t){if(this.options.heightAuto&&this.options.maxHeight>40){var i=t.span,e=i.offsetHeight,o=(i.offsetWidth,$(i).clone()[0]),n=!1;t.span.parentNode.appendChild(o);var s=i.style.display;i.style.display="none",o.style.height="",o.style.maxHeight="999999px";return o.offsetHeight>e&&(n=!0),t.span.parentNode.removeChild(o),i.style.display=s,n}},renderTypeSumRow=function(t,i,e,o,n){},renderTypeGroupSumRow=function(){},renderTypeFunObj={renderTypeFun:renderTypeFun,renderTypeByColumn:renderTypeByColumn,renderTypeSumRow:renderTypeSumRow,renderTypeGroupSumRow:renderTypeGroupSumRow,getRenderOverFlag:getRenderOverFlag},setColumnVisibleByColumn=function(t,i){var e=this.getIndexOfColumn(t);this.setColumnVisibleByIndex(e,i)},setColumnVisibleByIndex=function(t,i){if(t>=0){var e=this.gridCompColumnArr[t],o=this.getVisibleIndexOfColumn(e),n=e.options.canVisible,s=$("input:checked",$("#"+this.options.id+"_column_menu_columns_ul")).length;if(!n||1==s&&0==i)return;if(0==e.options.visible&&i){var r="<col";e.options.width&&(r+=' style="width:'+this.formatWidth(e.options.width)+'"'),r+=">";var d=this.getNextVisibleInidexOfColumn(e);if($("#"+this.options.id+"_header_table th:eq("+t+")").css("display",""),$("#"+this.options.id+"_content_table th:eq("+t+")").css("display",""),$("td:eq("+t+")",$("#"+this.options.id+"_content tbody tr")).css("display",""),d<1){this.lastVisibleColumn=e;try{$("#"+this.options.id+"_header_table col:last")[0].insertAdjacentHTML("afterEnd",r),$("#"+this.options.id+"_content_table col:last")[0].insertAdjacentHTML("afterEnd",r)}catch(t){$("#"+this.options.id+"_header_table col:last").after(r),$("#"+this.options.id+"_content_table col:last").after(r)}}else try{$("#"+this.options.id+"_header_table col:eq("+(d-1)+")")[0].insertAdjacentHTML("beforeBegin",r),$("#"+this.options.id+"_content_table col:eq("+(d-1)+")")[0].insertAdjacentHTML("beforeBegin",r)}catch(t){$("#"+this.options.id+"_header_table col:eq("+(d-1)+")").before(r),$("#"+this.options.id+"_content_table col:eq("+(d-1)+")").before(r)}var l=this.contentWidth+parseInt(e.options.width);$("#"+this.options.id+"_column_menu_columns_ul li input:eq("+t+")")[0].checked=!0}if(1==e.options.visible&&!i){$("#"+this.options.id+"_header_table th:eq("+t+")").css("display","none"),$("#"+this.options.id+"_header_table col:eq("+o+")").remove(),$("#"+this.options.id+"_content_table th:eq("+t+")").css("display","none"),$("#"+this.options.id+"_content_table col:eq("+o+")").remove(),$("td:eq("+t+")",$("#"+this.options.id+"_content_table tbody tr")).css("display","none");var l=this.contentWidth-parseInt(e.options.width);if($("#"+this.options.id+"_column_menu_columns_ul li input:eq("+t+")")[0].checked=!1,this.lastVisibleColumn==e){var a=this.getAllVisibleColumns();this.lastVisibleColumn=a[a.length-1]}}e.options.visible=i;var h=this.contentWidthChange(l);if(this.lastVisibleColumn.options.width=this.lastVisibleColumnWidth,this.contentWidth=h,this.resetThVariable(),this.noScrollWidthReset(),this.contentMinWidth=parseInt(this.wholeWidth)-parseInt(this.leftW)-parseInt(this.fixedWidth),this.contentMinWidth<0&&(this.contentMinWidth=0),this.contentRealWidth<this.contentMinWidth){this.contentWidth=this.contentMinWidth;var u=this.lastVisibleColumn.options.width;this.lastVisibleColumnWidth=u+(this.contentMinWidth-this.contentRealWidth),this.lastVisibleColumn.options.width=this.lastVisibleColumnWidth}else this.contentWidth=this.contentRealWidth;this.resetColumnWidthByRealWidth(),this.saveGridCompColumnArrToLocal();var c=$("input",$("#"+this.options.id+"_column_menu_ul .header"));if(c.length>0){var p=$("input:not(:checked)",$("#"+this.options.id+"_column_menu_columns_ul")).length;c[0].checked=!(p>0)}}},resetColumnWidthByRealWidth=function(){var t=this;$.each(this.gridCompColumnArr,function(){this.options.realWidth!=this.options.width&&t.setColumnWidth(this,this.options.realWidth)}),this.resetLastVisibleColumnWidth()},setCoulmnWidthByField=function(t,i){var e=this.getColumnByField(t);this.setColumnWidth(e,i)},setColumnWidth=function(t,i){if(i>this.minColumnWidth||i==this.minColumnWidth){var e=this.getVisibleIndexOfColumn(t),o=t.options.width,n=i-o,s=this.contentWidth+n;this.contentWidth=this.contentWidthChange(s),$("#"+this.options.id+"_header_table col:eq("+e+")").css("width",i+"px"),$("#"+this.options.id+"_content_table col:eq("+e+")").css("width",i+"px"),t.options.width=i,t.options.realWidth=i,this.resetThVariable(),this.saveGridCompColumnArrToLocal()}this.resetLastVisibleColumnWidth(),this.columnsVisibleFun()},setDataSource=function(t){this.$ele.data("gridComp")==this&&(this.initDataSourceVariable(),this.options.dataSource=t,this.initDataSource(),"grid"==this.showType&&(this.widthChangeGridFun(),this.dataSourceObj.rows.length>0?$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","block"):$("#"+this.options.id+"_grid .u-grid-noScroll-left").css("display","none")))},setDataSourceFun1=function(t){var i={};if(t.values){var e=new Array;$.each(t.values,function(){if(t.fields){var i={},o=this;$.each(t.fields,function(t){$(i).attr(this,o[t])}),e.push(i)}})}$(i).attr("values",e),this.setDataSource(i)},setFunObj={setColumnVisibleByColumn:setColumnVisibleByColumn,setColumnVisibleByIndex:setColumnVisibleByIndex,setCoulmnWidthByField:setCoulmnWidthByField,setColumnWidth:setColumnWidth,setDataSource:setDataSource,setDataSourceFun1:setDataSourceFun1,resetColumnWidthByRealWidth:resetColumnWidthByRealWidth},widthChangeFun=function(){var t=this;if($("#"+this.options.id)[0]){var i=$("#"+this.options.id)[0].offsetWidth;this.wholeWidth!=i&&this.$ele.data("gridComp")==this&&0!=i&&(this.wholeWidth=i,i>this.options.formMaxWidth&&("form"==this.showType||""==this.showType||!$("#"+this.options.id+"_content_div tbody")[0])||this.options.overWidthHiddenColumn||this.options.noScroll?t.widthChangeGridFun():i>0&&i<this.options.formMaxWidth&&("grid"==this.showType||this.showType),i>this.options.formMaxWidth&&(this.contentMinWidth=parseInt(this.wholeWidth)-parseInt(this.leftW)-parseInt(this.fixedWidth),this.contentMinWidth<0&&(this.contentMinWidth=0),setTimeout(function(){$("#"+t.options.id+"_header_wrap").css("max-width",t.wholeWidth+"px"),$("#"+t.options.id+"_content_div").css("width",t.contentMinWidth+"px"),$("#"+t.options.id+"_content_table").css("min-width",t.contentMinWidth+"px"),$("#"+t.options.id+"_content_table").css("width",t.contentMinWidth+"px"),$("#"+t.options.id+"_header_table").css("min-width",t.contentMinWidth+"px"),$("#"+t.options.id+"_header_table").css("width",t.contentMinWidth+"px"),$("#"+t.options.id+"_noRowsShow").css("width",t.contentMinWidth+"px"),t.columnsVisibleFun(),t.contentRealWidth<t.contentMinWidth?t.contentWidth=t.contentMinWidth:t.contentWidth=t.contentRealWidth,$("#"+t.options.id+"_noRows").css("width",t.contentWidth+"px"),"function"==typeof t.options.afterCreate&&t.options.afterCreate.call(t)},300)),$("#"+t.options.id+"_header_table").css("width",t.contentMinWidth+"px"),$("#"+t.options.id+"_edit_form").css("width",t.contentMinWidth+"px"),this.preWholeWidth=i,this.resetLeftHeight())}},widthChangeGridFun=function(){var t=parseInt(this.wholeWidth/2);if(this.noScrollWidthReset(),this.widthChangeGridFunFixed(t),this.widthChangeGridFunOverWidthHidden(),this.contentMinWidth=parseInt(this.wholeWidth)-parseInt(this.leftW)-parseInt(this.fixedWidth),this.contentMinWidth<0&&(this.contentMinWidth=0),this.contentRealWidth<this.contentMinWidth){this.contentWidth=this.contentMinWidth;var i=this.lastVisibleColumn.options.width;this.lastVisibleColumnWidth=i+(this.contentMinWidth-this.contentRealWidth),this.lastVisibleColumn.options.width=this.lastVisibleColumnWidth}else this.contentWidth=this.contentRealWidth;this.createGridFlag=!1,this.createGridDivs(),$("#"+this.options.id+"_form").css("display","none"),$("#"+this.options.id+"_grid").css("display","block")},noScrollWidthReset=function(){if(this.options.noScroll){for(var t=0,i=0;i<this.gridCompColumnArr.length;i++){var e=this.gridCompColumnArr[i],o=e.options.optionsWidth+"",n=this.wholeWidth-this.leftW;if(o.indexOf("%")>0)var s=parseInt(o.replace("%","")*n/100);else var s=parseInt(o);s<this.minColumnWidth&&(s=this.minColumnWidth),e.options.visible&&(t+=parseInt(s)),this.setColumnWidth(e,s)}this.hasNoScrollRest=!0}if(t>n){var r=this.lastVisibleColumn,d=r.options.width,l=d-(t-n);this.setColumnWidth(r,l)}},widthChangeGridFunFixed=function(t){},widthChangeGridFunOverWidthHidden=function(){},heightChangeFun=function(){if(this.countContentHeight){var t=this.wholeHeight,i=$("#"+this.options.id)[0].offsetHeight;if(this.wholeHeight=i,t!=i&&i>0){var e=i-1-this.exceptContentHeight>0?i-1-this.exceptContentHeight:0;$("#"+this.options.id+"_content").css("height",e+"px"),$("#"+this.options.id+"_content_div").css("height",e+"px")}}},contentWidthChange=function(t){if(t<this.contentMinWidth){var i=parseInt(this.lastVisibleColumn.options.width);this.lastVisibleColumnWidth=i+(this.contentMinWidth-t),$("#"+this.options.id+"_header_table col:last").css("width",this.lastVisibleColumnWidth+"px"),$("#"+this.options.id+"_content_table col:last").css("width",this.lastVisibleColumnWidth+"px"),t=this.contentMinWidth}return t>this.contentMinWidth&&this.contentMinWidth,this.options.noScroll||($("#"+this.options.id+"_content_table").css("width",t+"px"),$("#"+this.options.id+"_header_table").css("width",t+"px"),$("#"+this.options.id+"_noRows").css("width",t+"px")),t},wdChangeFunObj={widthChangeFun:widthChangeFun,widthChangeGridFun:widthChangeGridFun,widthChangeGridFunFixed:widthChangeGridFunFixed,widthChangeGridFunOverWidthHidden:widthChangeGridFunOverWidthHidden,heightChangeFun:heightChangeFun,contentWidthChange:contentWidthChange,noScrollWidthReset:noScrollWidthReset},isDblEvent=function(t,i,e,o,n){if(null!=this.currentEventName&&this.currentEventName==t)i.call(this,e),this.currentEventName=null,this.cleanCurrEventName&&clearTimeout(this.cleanCurrEventName);else{var s=this;this.cleanCurrEventName&&clearTimeout(this.cleanCurrEventName),this.currentEventName=t,this.cleanCurrEventName=setTimeout(function(){s.currentEventName=null,o.call(s,n)},250)}},dblClickFun=function(t){if("function"==typeof this.options.onDblClickFun){var i=$(t.target).closest("tr");if(i[0].id==this.options.id+"_edit_tr")return;var e=0;i.length>0&&(e=this.getTrIndex(i));var o={};o.gridObj=this,o.rowObj=this.dataSourceObj.rows[e],o.rowIndex=e,this.options.onDblClickFun(o)}},clickFun=function(t){var i=this,e=$(t.target).closest("tr");if(!(e.length>0&&e[0].id==this.options.id+"_edit_tr")){var o=this.getTrIndex(e);if("function"==typeof this.options.onBeforeClickFun){var n={};if(n.gridObj=this,n.rowObj=this.dataSourceObj.rows[o],n.rowIndex=o,n.e=t,!this.options.onBeforeClickFun(n))return}if(this.clickFunTree(t),e.length>0){var s=i.dataSourceObj.rows[o];if(s){if(i.options.rowClickBan)return;this.clickFunEdit(t,o);i.getChildRowIndex(s);!i.options.contentFocus&&i.options.multiSelect||(i.dataSourceObj.rows[o].focus&&i.options.cancelFocus?i.setRowUnFocus(o):i.dataSourceObj.rows[o].focus||i.setRowFocus(o)),!i.options.contentSelect&&i.options.multiSelect||(i.dataSourceObj.rows[o].checked&&i.options.cancelSelect?i.setRowUnselect(o):i.dataSourceObj.rows[o].checked||i.setRowSelect(o))}}}},clickFunTree=function(t){},clickFunEdit=function(t){},clickFunObj={isDblEvent:isDblEvent,dblClickFun:dblClickFun,clickFun:clickFun,clickFunTree:clickFunTree,clickFunEdit:clickFunEdit},updateLastRowFlag=function(){return},updateNumColLastRowFlag=function(){return},columnsVisibleFun=function(){var t=this,i=0;this.firstColumn=!0,this.overWidthVisibleColumnArr=new Array,$.each(this.gridCompColumnArr,function(){this.options.visible&&(i+=parseInt(this.options.width),this.options.width>this.options.realWidth&&t.overWidthVisibleColumnArr.push(this),this.firstColumn=t.firstColumn,t.firstColumn=!1,t.lastVisibleColumn=this,t.lastVisibleColumnWidth=this.options.width)}),this.contentRealWidth=i},resetLastVisibleColumnWidth=function(){for(var t=this.getAllVisibleColumns(),i=t.length,e=0,o=0,n=0;n<t.length;n++){var s=t[n];n==i-1-this.options.expandColumnIndex?(o=s.options.realWidth,this.lastVisibleColumn=s):e+=s.options.width}if(e<this.contentMinWidth){var r=this.contentMinWidth-e;r>o&&(o=r)}if(this.lastVisibleColumnWidth=o,this.lastVisibleColumn.options.width=o,0==this.options.expandColumnIndex)$("#"+this.options.id+"_header_table col:last").css("width",this.lastVisibleColumnWidth+"px"),$("#"+this.options.id+"_content_table col:last").css("width",this.lastVisibleColumnWidth+"px");else{var d=i-this.options.expandColumnIndex-1;$("#"+this.options.id+"_header_table col:eq("+d+")").css("width",this.lastVisibleColumnWidth+"px"),$("#"+this.options.id+"_content_table col:eq("+d+")").css("width",this.lastVisibleColumnWidth+"px")}},resetThVariable=function(){if("grid"==this.showType){var t=this;this.contentWidth=0,$("#"+this.options.id+"_header_table th",this.$ele).each(function(i){var e=t.gridCompColumnArr[i],o=0;e.options.visible&&(o=parseInt(e.options.width)),this.attrLeftTotalWidth=t.contentWidth,t.contentWidth+=o,t.resetThVariableDrag(this,e,o),this.gridCompColumn=e,this.attrWidth=o,this.attrRightTotalWidth=t.contentWidth}),t.resetThVariableHeaderLevel()}},resetThVariableDrag=function(t,i){},resetThVariableHeaderLevel=function(){},headerFirstClassFun=function(){$("#"+this.options.id+"_grid .u-grid-header-th-first").removeClass("u-grid-header-th-first"),$("#"+this.options.id+"_grid").find("th").eq(0).addClass("u-grid-header-th-first")},setRenderType=function(t,i){var e=this.getColumnByField(t);e.options.renderType=i;var o=this.getIndexOfColumn(e);this.renderTypeByColumn(e,o)},setShowHeader=function(t){this.options.showHeader=t,t?$("#"+this.options.id+"_header").css("display","block"):$("#"+this.options.id+"_header").css("display","none")},setColumnPrecision=function(t,i){this.getColumnByField(t).options.precision=i,this.renderTypeFun(),this.options.showSumRow&&this.repairSumRow()},setMultiSelect=function(t){this.options.multiSelect!=t&&(this.options.multiSelect=t,this.initGrid())},setShowNumCol=function(t){this.options.showNumCol!=t&&(this.options.showNumCol=t,this.initGrid())},isGridShow=function(){return"grid"==this.showType},getBoolean=function(t){return"true"===t||!0===t},otherFunObj={updateLastRowFlag:updateLastRowFlag,updateNumColLastRowFlag:updateNumColLastRowFlag,columnsVisibleFun:columnsVisibleFun,resetThVariable:resetThVariable,resetThVariableDrag:resetThVariableDrag,resetThVariableHeaderLevel:resetThVariableHeaderLevel,headerFirstClassFun:headerFirstClassFun,setRenderType:setRenderType,setShowHeader:setShowHeader,setColumnPrecision:setColumnPrecision,setMultiSelect:setMultiSelect,setShowNumCol:setShowNumCol,isGridShow:isGridShow,resetLastVisibleColumnWidth:resetLastVisibleColumnWidth,getBoolean:getBoolean},formatWidth=function(t){return t?(t+"").indexOf("%")>0?t:parseInt(t)+"px":""},swapEle=function(t,i){var e=t.next(),o=i.prev();i.insertBefore(e),t.insertAfter(o)},getString=function(t,i){return null!==t&&void 0!==t&&"null"!==t&&"undefined"!==t&&""!==t||(t=i),gridBrowser.isIE8?[t].join(""):t+""},getInt=function(t,i){return(null===t||void 0===t||"null"===t||"undefined"===t||""===t||isNaN(t))&&(t=i),t},getFloat=function(t,i){return(null===t||void 0===t||"null"===t||"undefined"===t||""===t||isNaN(t))&&(t=i),t},cloneObj=function(t){var i;if("object"==(void 0===t?"undefined":_typeof(t)))if(null===t)i=null;else if(t instanceof Array){i=[];for(var e=0,o=t.length;e<o;e++)i.push(this.cloneObj(t[e]))}else{i={};for(var n in t)i[n]=this.cloneObj(t[n])}else i=t;return i},DicimalFormater=function(t){for(var i=t.value+"",e=t.precision,o=0;o<i.length;o++)if(-1=="-0123456789.".indexOf(i.charAt(o)))return"";return checkDicimalInvalid(i,e)},checkDicimalInvalid=function(t,i){if(null==t||isNaN(t))return"";var e=parseFloat(t),o=(e*Math.pow(10,i)/Math.pow(10,i)).toFixed(i);return"NaN"==o?"":o},accAdd=function(t,i){var e,o,n;try{e=t.toString().split(".")[1].length}catch(t){e=0}try{o=i.toString().split(".")[1].length}catch(t){o=0}return n=Math.pow(10,Math.max(e,o)),(t*n+i*n)/n},getTrIndex=function(t){return $('tr[id!="'+this.options.id+'_edit_tr"][role="row"]',t.parent()).index(t)},getDataTableRowIdByRow=function(t){return t.value["$_#_@_id"]};String.prototype.substrCH=function(t){for(var i=0,e=0;i<t&&e<this.length;){var o=this.charCodeAt(e);if(o>256&&i==t-1)break;i+=o>256?2:1,e+=1}return this.substr(0,e)};var SortByFun=function(t,i,e){var o=this;return function(n,s){var r=$(n.value).attr(t),d=$(s.value).attr(t),l=o.getColumnByField(t).options.dataType;if("Float"==l)return r=parseFloat(r),
d=parseFloat(d),isNaN(r)?1:isNaN(d)?-1:r==d&&e?e.apply(o,arguments):"asc"==i?r-d:"desc"==i?d-r:0;if("Int"==l)return r=parseInt(r),d=parseInt(d),isNaN(r)?1:isNaN(d)?-1:r==d&&e?e.apply(o,arguments):"asc"==i?r-d:"desc"==i?d-r:0;r=o.getString(r,""),d=o.getString(d,"");try{var a=r.localeCompare(d);return 0===a&&e?e.apply(o,arguments):0===a?0:"asc"==i?a:"desc"==i?-a:0}catch(t){return 0}}},utilFunOjb={formatWidth:formatWidth,swapEle:swapEle,getString:getString,getInt:getInt,getFloat:getFloat,cloneObj:cloneObj,DicimalFormater:DicimalFormater,accAdd:accAdd,getTrIndex:getTrIndex,getDataTableRowIdByRow:getDataTableRowIdByRow,SortByFun:SortByFun},re_initGridCompColumnColumnMenuFun=function(t){var i=new this.gridCompColumn(t,this);i.options.realWidth=i.options.width,this.basicGridCompColumnArr.push(i)},colMenu_initGridCompColumn=function(){this.menuColumnsHeight=this.gridCompColumnArr.length*this.columnMenuHeight},re_createColumnMenu=function(){return"base"==this.options.columnMenuType?re_createColumnMenu_base.call(this):"border"==this.options.columnMenuType?re_createColumnMenu_border.call(this):void 0},re_createColumnMenu_base=function(){var t=this,i='<div class="u-grid-column-menu" id="'+this.options.id+'_column_menu">';return i+='<ul data-role="menu" role="menubar" class="u-grid-column-menu-ul" id="'+this.options.id+'_column_menu_ul">',i+='<li class="u-grid-column-menu-li" role="menuitem">',i+='<div class="u-grid-column-menu-div1" id="'+this.options.id+'_clearSet">',i+='<span class="u-grid-column-menu-span">'+this.transMap.ml_clear_set+"</span>",i+="</div></li>",i+='<div class="u-grid-column-menu-columns" id="'+this.options.id+'_column_menu_columns">',i+='<ul data-role="menu" role="menubar" class="u-grid-column-menu-columns-ul" id="'+this.options.id+'_column_menu_columns_ul">',$.each(this.gridCompColumnArr,function(e){if(""!=t.getString(this.options.title,"")){var o="";this.options.canVisible||(o+=' style="display:none;"'),i+='<li class="u-grid-column-menu-columns-li" role="menuitem" index="'+e+'" '+o+">",i+='<div class="u-grid-column-menu-columns-div1">';var n="";this.options.visible&&(n=" checked"),i+='<div class="u-grid-column-menu-columns-div2"><input type="checkbox" '+n+"><label></label></div>",i+='<span class="u-grid-column-menu-columns-span">'+this.options.title+"</span>",i+="</div></li>"}}),i+="</ul></div>",i+="</ul></div>"},re_createColumnMenu_border=function(){var t=this,i='<div class="u-grid-column-menu-border" id="'+this.options.id+'_column_menu">';i+='<ul data-role="menu" role="menubar" class="u-grid-column-menu-ul-border" id="'+this.options.id+'_column_menu_ul">';var e='<div class="u-grid-column-menu-columns" id="'+this.options.id+'_column_menu_columns">';e+='<ul data-role="menu" role="menubar" class="u-grid-column-menu-columns-ul-border" id="'+this.options.id+'_column_menu_columns_ul">';var o=!0;$.each(this.gridCompColumnArr,function(i){if(""!=t.getString(this.options.title,"")){var n="";this.options.canVisible||(n+=' style="display:none;"'),e+='<li class="u-grid-column-menu-columns-li" role="menuitem" index="'+i+'" '+n+">",e+='<div class="u-grid-column-menu-columns-div1-border">';var s="";this.options.visible&&(s=" checked"),this.options.canVisible&&!this.options.visible&&(o=!1),e+='<div class="u-grid-column-menu-columns-div2-border"><input type="checkbox" '+s+"><label></label></div>",e+='<span class="u-grid-column-menu-columns-span-border">'+this.options.title+"</span>",e+="</div></li>"}}),e+="</ul></div>";var n="";o&&(n=" checked ");var s='<li class="u-grid-column-menu-columns-li header" role="menuitem">';return s+='<div class="u-grid-column-menu-columns-div1-border">',s+='<div class="u-grid-column-menu-columns-div2-border"><input type="checkbox" '+n+"><label></label>&nbsp;显示</div>",s+='<span class="u-grid-column-menu-columns-span-border" style="text-align:center;">项目名称</span>',s+="</div></li>",i+=s,i+=e,i+="</ul>",i+='<div class="u-grid-column-menu-div1-border" id="'+this.options.id+'_clearSet">',i+='<span class="u-grid-column-menu-span-border">'+this.transMap.ml_clear_set+"</span>",i+="</div>",i+="</div>"},colMenu_initEventFun=function(){var t=this;$("#"+this.options.id).on("mouseup",function(i){if($(i.target).closest("#"+t.options.id+"_header").length>0){if(t.mouseUpX=i.clientX,t.mouseUpY=i.clientY,t.mouseDownX==t.mouseUpX&&t.mouseDownY==t.mouseUpY){t.columnClickX=i.clientX,t.columnClickY=i.clientY;$(i.target).closest("th")[0];if($(i.target).hasClass("u-grid-header-columnmenu")){if($("#"+t.options.id+"_column_menu").css("display","block"),"base"==t.options.columnMenuType)var e=i.clientX-160;else if("border"==t.options.columnMenuType)var e=i.clientX-240;e<0&&(e=0);var o=i.clientY+10;$("#"+t.options.id+"_column_menu").css("left",e),$("#"+t.options.id+"_column_menu").css("top",o);var n=($(window).width(),$(window).height()),s=t.menuColumnsHeight;t.menuColumnsHeight+o+34>n?(s=n-o-34,$("#"+t.options.id+"_column_menu_columns").css("height",s+"px")):$("#"+t.options.id+"_column_menu_columns").css("height",""),t.ele.createColumnMenuFlag=!0}}}else $(i.target).closest("#"+t.options.id+"_content").length}),$(document).on("click",function(){0==t.columnMenuMove&&0==t.ele.createColumnMenuFlag&&t.ele.offsetWidth>0&&$("#"+t.options.id+"_column_menu").css("display","none"),t.ele.createColumnMenuFlag=!1}),$(document).on("scroll",function(){0==t.columnMenuMove&&0==t.ele.createColumnMenuFlag&&t.ele.offsetWidth>0&&$("#"+t.options.id+"_column_menu").css("display","none"),t.ele.createColumnMenuFlag=!1})},colMenu_initGridEventFun=function(){var t=this;$("#"+this.options.id+"_column_menu_ul").off("mousemove"),$("#"+this.options.id+"_column_menu_ul").on("mousemove",function(i){t.columnMenuMove=!0}),$("#"+this.options.id+"_column_menu_ul").off("mouseout"),$("#"+this.options.id+"_column_menu_ul").on("mouseout",function(i){t.columnMenuMove=!1}),$("#"+this.options.id+"_clearSet").off("click"),$("#"+this.options.id+"_clearSet").on("click",function(i){t.clearLocalData(),t.initGridCompColumn(),t.hasNoScrollRest=!1,t.noScrollWidthReset(),t.dataSourceObj.sortRows(),t.repaintGridDivs(),"function"==typeof t.options.onClearSetFun&&t.options.onClearSetFun(t)}),$("#"+this.options.id+"_column_menu_columns_ul li input").off("click"),$("#"+this.options.id+"_column_menu_columns_ul li input").on("click",function(i){var e=$(this).closest("li").attr("index");if(t.gridCompColumnArr[e].options.visible){$(this)[0].checked=!1;if(0==$("input:checked",$("#"+t.options.id+"_column_menu_columns_ul")).length)return void($(this)[0].checked=!0);if(8==document.documentMode){var o=$("#"+t.options.id+"_column_menu_columns")[0].scrollTop,n=$("#"+t.options.id+"_column_menu")[0].style.top,s=$("#"+t.options.id+"_column_menu")[0].style.left;t.gridCompColumnArr[e].options.visible=!1,t.repaintGridDivs(),$("#"+t.options.id+"_column_menu").css("display","block"),$("#"+t.options.id+"_column_menu").css("left",s),$("#"+t.options.id+"_column_menu").css("top",n),$("#"+t.options.id+"_column_menu_columns")[0].scrollTop=o}else t.setColumnVisibleByIndex(e,!1),t.gridCompColumnArr[e].options.visible=!1}else if($(this)[0].checked=!0,8==document.documentMode){var o=$("#"+t.options.id+"_column_menu")[0].scrollTop,n=$("#"+t.options.id+"_column_menu")[0].style.top,s=$("#"+t.options.id+"_column_menu")[0].style.left;t.gridCompColumnArr[e].options.visible=!0,t.repaintGridDivs(),$("#"+t.options.id+"_column_menu").css("display","block"),$("#"+t.options.id+"_column_menu").css("left",s),$("#"+t.options.id+"_column_menu").css("top",n),$("#"+t.options.id+"_column_menu_columns")[0].scrollTop=o}else t.setColumnVisibleByIndex(e,!0),t.gridCompColumnArr[e].options.visible=!0;t.saveGridCompColumnArrToLocal(),i.stopPropagation()}),$("#"+this.options.id+"_column_menu_columns_ul li").off("click"),$("#"+this.options.id+"_column_menu_columns_ul li").on("click",function(t){$(this).find("input").click()}),$("#"+this.options.id+"_column_menu_ul .header input").on("click",function(i){var e=$(this)[0].checked;$.each(t.gridCompColumnArr,function(i){t.setColumnVisibleByColumn(this,e)})})},re_createHeaderDrag=function(){return'<div class="u-grid-header-resize-handle" id="'+this.options.id+'_resize_handle"><div class="u-grid-header-resize-handle-inner"></div></div>'},drag_initEventFun=function(){var t=this;$("#"+this.options.id).on("mousemove",function(i){if($(i.target).closest("#"+t.options.id+"_header").length>0){var e=$(i.target).closest("th")[0];t.headerThDrag(i,e)}t.dragFun(i)}),$("#"+this.options.id+"_top").on("mousemove",function(i){t.dragFun(i),i.stopPropagation()}),$("#"+this.options.id).on("mouseup",function(i){t.dragEnd(i)}),$("#"+this.options.id+"_top").on("mouseup",function(i){t.dragEnd(i)})},drag_initGridEventFun=function(){var t=this;$("#"+this.options.id+"_resize_handle").on("mousedown",function(i){t.dragStart(i)})},dragStart=function(t){this.dragFlag=!0,this.dragW=null,this.dragStartX=t.clientX},dragFun=function(t){if(this.dragFlag){var i=$("#"+this.options.id+"_resize_handle")[0].nowTh,e=$(i),o=e.attr("index"),n=this.gridCompColumnArr[o],s=this.getVisibleIndexOfColumn(n);if(i&&n!=this.lastVisibleColumn){this.dragEndX=t.clientX;var r=parseInt(this.dragEndX)-parseInt(this.dragStartX),d=parseInt(i.attrWidth)+parseInt(r),l=parseInt(this.contentWidth)+parseInt(r);if(d>this.minColumnWidth){if(this.options.noScroll){var a=this.getNextVisibleInidexOfColumn(n);if(a>-1){var h=this.getColumnByVisibleIndex(a);(!this.dragNextClomunWidth||this.dragNextClomunWidth<0)&&(this.dragNextClomunWidth=h.options.width)}var u=parseInt(this.dragNextClomunWidth)-parseInt(r);if(!(u>this.minColumnWidth))return void $("#"+this.options.id+"_top").css("display","block")}this.options.noScroll||(this.dragW=this.contentWidthChange(l)),$("#"+this.options.id+"_header_table col:eq("+s+")").css("width",d+"px"),$("#"+this.options.id+"_content_table col:eq("+s+")").css("width",d+"px"),n.options.width=d,n.options.realWidth=d,n.options.optionsWidth=d,this.options.noScroll&&($("#"+this.options.id+"_header_table col:eq("+a+")").css("width",u+"px"),$("#"+this.options.id+"_content_table col:eq("+a+")").css("width",u+"px"),h.options.width=u,h.options.realWidth=u,h.options.optionsWidth=u)}}$("#"+this.options.id+"_top").css("display","block")}},dragEnd=function(t){this.dragFlag&&(this.resetThVariable(),this.saveGridCompColumnArrToLocal(),this.resetLeftHeight()),this.dragNextClomunWidth=-1,this.dragW&&(this.contentWidth=this.dragW),$("#"+this.options.id+"_resize_handle")[0].nowTh=null,this.dragFlag=!1,$("#"+this.options.id+"_top").css("display","none")},headerThDrag=function(t,i){if(!this.dragFlag&&!this.swapColumnFlag&&i&&i.gridCompColumn&&i.gridCompColumn.options.canDrag&&$("#"+this.options.id+"_resize_handle")[0].nowTh!=i){$(i);$("#"+this.options.id+"_resize_handle").css("left",i.attrRightTotalWidth-this.scrollLeft-4+this.leftW+this.fixedWidth),$("#"+this.options.id+"_resize_handle")[0].nowTh=i}},re_resetThVariableDrag=function(t,i,e){!$("#"+this.options.id+"_resize_handle")[0].nowTh&&i.options.canDrag&&($("#"+this.options.id+"_resize_handle").css("left",e-4+this.leftW),$("#"+this.options.id+"_resize_handle")[0].nowTh=t)},dragFunObj={createHeaderDrag:re_createHeaderDrag,dragStart:dragStart,dragFun:dragFun,dragEnd:dragEnd,headerThDrag:headerThDrag,resetThVariableDrag:re_resetThVariableDrag,drag_initEventFun:drag_initEventFun,drag_initGridEventFun:drag_initGridEventFun},re_hideEditMenu=function(){$("#"+this.options.id+"_content_edit_menu").css("display","none")},re_clickFunEdit=function(t,i){var e=$(t.target).closest("tr"),o=$(t.target).closest("td"),n=o.index();this.options.editable&&(this.eidtRowIndex!=i||"default"==this.options.editType&&this.editColIndex!=n)&&(this.editClose(),this.editRowFun(e,n))},editRowFun=function(t,i){var e=this.getTrIndex(t);if("function"==typeof this.options.onBeforeEditFun){var o={};if(o.gridObj=this,o.rowObj=this.dataSourceObj.rows[e],o.rowIndex=e,o.colIndex=i,o.$tr=t,!this.options.onBeforeEditFun(o))return void(-1!=this.eidtRowIndex&&this.editClose())}-1!=this.eidtRowIndex&&this.editClose();var e="number"==typeof t?t:this.getTrIndex(t);return this.eidtRowIndex=e,this.editColIndex=i,this.editRow(t,i),!0},editRowIndexFun=function(t){-1!=this.eidtRowIndex&&this.editClose(),this.eidtRowIndex=t,this.editColIndex=0,this.editRow()},editRow=function(t,i){if(!(i<0)){var e=this,o=!1;t&&t.parents("table").attr("id").indexOf("_fixed_")>-1&&(o=!0),t=t||$("#"+this.options.id+'_content_tbody tr[role="row"]:eq('+this.eidtRowIndex+")"),i=i||0;var n=this.dataSourceObj.rows[this.eidtRowIndex].value;if(this.editRowObj=this.cloneObj(n),"default"==this.options.editType){var s=o?this.gridCompColumnFixedArr[i]:this.gridCompColumnArr[i];if(s.options.editable){var r=$("td:eq("+i+")",t)[0],d=s.options.field,l=$(n).attr(d);l=e.getString(l,"");var a={};a.td=r,a.value=l,a.field=d,a.editType=s.options.editType,a.rowObj=e.editRowObj,a.$tr=t,a.colIndex=i,e.editCell(a)}$("#"+this.options.id+"_content_edit_menu").css("display","block"),$("#"+this.options.id+"_content_edit_menu_cancel").css("marginLeft","10px");var h=$("tr:visible",t.parent()).index(t);this.rowHeight=t.height();this.rowHeight,this.headerHeight}else if("form"==this.options.editType)if("function"==typeof this.options.formEditRenderFun){if(this.fixedWidth>0)var u=$("#"+this.options.id+"_content_fixed_table")[0];else var u=$("#"+this.options.id+"_content_table")[0];var c=u.insertRow(this.eidtRowIndex+2);c.id=this.options.id+"_edit_tr",$(c).addClass("grid_edit_form_tr");var p=c.insertCell();p.id=this.options.id+"_edit_td",$(p).addClass("grid_edit_form_td"),p.style.borderBottom="0px",p.style.background="#fff";var m=parseInt(this.contentMinWidth)+parseInt(this.fixedWidth),f='<div id="'+this.options.id+'_edit_form" class="u-grid-edit-form" style="width:'+m+'px;float:left;">';f+="</div>",p.innerHTML=f;var a={};a.grid=gridObj,a.element=$("#"+this.options.id+"_edit_form")[0],a.editRowObj=this.editRowObj,this.options.formEditRenderFun.call(this,a);var f='<div style="position:relative;float:left;width:100%;height:40px;"></div>';$("#"+this.options.id+"_edit_form")[0].insertAdjacentHTML("beforeEnd",f);var g=$("#"+this.options.id+"_edit_td")[0].offsetHeight,w=$("#"+this.options.id+"_edit_form").css("background-color");if(this.options.multiSelect){var v=$("#"+this.options.id+"_content_multiSelect > div").eq(this.eidtRowIndex),f='<div class="grid_open_edit" id="'+this.options.id+'_multiSelect_edit" style="background-color:'+w+";float:left;position:relative;width:"+this.multiSelectWidth+"px;height:"+g+'px"></div>';v[0].insertAdjacentHTML("afterEnd",f)}if(this.options.showNumCol){var v=$("#"+this.options.id+"_content_numCol > .u-grid-content-num").eq(this.eidtRowIndex),f='<div id="'+this.options.id+'_numCol_edit" style="background-color:'+w+";float:left;position:relative;width:"+this.numWidth+'px;"></div>';v[0].insertAdjacentHTML("afterEnd",f)}if($("#"+this.options.id+"_content_edit_menu").css("display","block"),this.fixedWidth>0){var C=$("#"+this.options.id+"_content_table")[0],_=C.insertRow(this.eidtRowIndex+2);_.id=this.options.id+"_edit_tr1"}}else{if(this.fixedWidth>0)var u=$("#"+this.options.id+"_content_fixed_table")[0];else var u=$("#"+this.options.id+"_content_table")[0];var c=u.insertRow(this.eidtRowIndex+2);c.id=this.options.id+"_edit_tr",$(c).addClass("grid_edit_form_tr");var p=c.insertCell();p.id=this.options.id+"_edit_td",$(p).addClass("grid_edit_form_td"),p.style.borderBottom="0px";var m=parseInt(this.contentMinWidth)+parseInt(this.fixedWidth),f='<div id="'+this.options.id+'_edit_form" class="u-grid-edit-form" style="width:'+m+'px;float:left;">';if($.each(this.gridCompColumnFixedArr,function(t){var i=!1;if(this.options.editFormShow&&(this.options.editable||!this.options.editable&&e.options.noneEditableFormShow)&&(i=!0),i){var o=this.options.field,s=$(n).attr(o);s=e.getString(s,"");var r=this.options.title,d=this.options.headerColor;f+=e.formEditCell(s,o,r,this.options.required,d)}}),$.each(this.gridCompColumnArr,function(t){var i=!1;if(this.options.editFormShow&&(this.options.editable||!this.options.editable&&e.options.noneEditableFormShow)&&(i=!0),i){var o=this.options.field,s=$(n).attr(o);s=e.getString(s,"");var r=this.options.title,d=this.options.headerColor;f+=e.formEditCell(s,o,r,this.options.required,d)}}),f+="</div>",p.innerHTML=f,$.each(this.gridCompColumnFixedArr,function(o){var s=!1;if(this.options.editFormShow&&(this.options.editable||!this.options.editable&&e.options.noneEditableFormShow)&&(s=!0),s){var r=this.options.field,d=$("#"+e.options.id+"_edit_"+r)[0],l=$(n).attr(r);this.options.title;l=e.getString(l,"");var a={};a.td=d,d.innerHTML='<div class="u-grid-content-td-div" title=""></div>',a.value=l,a.field=r,a.editType=this.options.editType,a.rowObj=e.editRowObj,a.$tr=t,a.colIndex=i,f+=e.editCell(a)}}),$.each(this.gridCompColumnArr,function(o){var s=!1;if(this.options.editFormShow&&(this.options.editable||!this.options.editable&&e.options.noneEditableFormShow)&&(s=!0),s){var r=this.options.field,d=$("#"+e.options.id+"_edit_"+r)[0],l=$(n).attr(r);this.options.title;l=e.getString(l,"");var a={};a.td=d,d.innerHTML='<div class="u-grid-content-td-div" title=""></div>',a.value=l,a.field=r,a.editType=this.options.editType,a.rowObj=e.editRowObj,a.$tr=t,a.colIndex=i,f+=e.editCell(a)}}),"function"==typeof this.options.renderEditMemu)this.options.renderEditMemu.apply(this,[$("#"+this.options.id+"_edit_form")[0],this.eidtRowIndex,this.dataSourceObj.rows.length]);else{var f='<div id="'+this.options.id+'_content_edit_menu" style="position:relative;float:left;width:100%;height:40px;"><button type="button" class="u-grid-content-edit-menu-button u-grid-content-edit-menu-button-ok" id="'+this.options.id+'_content_edit_menu_close">'+this.transMap.ml_close+"</button></div>";$("#"+this.options.id+"_edit_form")[0].insertAdjacentHTML("beforeEnd",f),$("#"+this.options.id+"_content_edit_menu_close").on("click",function(t){e.editClose()})}var g=$("#"+this.options.id+"_edit_td")[0].offsetHeight,w=$("#"+this.options.id+"_edit_form").css("background-color");if(this.options.multiSelect){var v=$("#"+this.options.id+"_content_multiSelect > div").eq(this.eidtRowIndex),f='<div class="grid_open_edit " id="'+this.options.id+'_multiSelect_edit" style="background-color:'+w+";float:left;position:relative;width:"+this.multiSelectWidth+"px;height:"+g+'px"></div>';v[0].insertAdjacentHTML("afterEnd",f)}if(this.options.showNumCol){var v=$("#"+this.options.id+"_content_numCol > .u-grid-content-num").eq(this.eidtRowIndex),f='<div id="'+this.options.id+'_numCol_edit" style="background-color:'+w+";float:left;position:relative;width:"+this.numWidth+'px;"></div>';v[0].insertAdjacentHTML("afterEnd",f)}if($("#"+this.options.id+"_content_edit_menu").css("display","block"),this.fixedWidth>0){var C=$("#"+this.options.id+"_content_table")[0],_=C.insertRow(this.eidtRowIndex+2);_.id=this.options.id+"_edit_tr1"}}}},re_editClose=function(){if(!(this.eidtRowIndex<0||this.editColIndex<0)){var t=this.dataSourceObj.rows[this.eidtRowIndex],i=this.gridCompColumnArr[this.editColIndex].options.field,e=null;this.editComp&&this.editComp.hide&&(this.editComp.hide(),!1);try{var e=this.editComp.element.parentNode.querySelector("input")}catch(t){}e&&(e.blur(),!1),this.editComp&&this.editComp.comp&&this.editComp.comp.hide&&(this.editComp.comp.hide(),!1);try{$("#"+this.options.id+"_placeholder_div").remove()}catch(t){}if(t){if("form"!=this.options.editType){var o={};o.begin=this.eidtRowIndex,o.length=1,o.field=i,this.renderTypeFun(o)}$("#"+this.options.id+"_content_edit_menu").css("display","none"),this.repairSumRow(),this.noRowsShowFun(),this.updateLastRowFlag(),this.eidtRowIndex=-1,$("#"+this.options.id+"_multiSelect_edit").remove(null,!0),$("#"+this.options.id+"_numCol_edit").remove(null,!0),$("#"+this.options.id+"_edit_tr").remove(null,!0),$("#"+this.options.id+"_edit_tr1").remove(null,!0)}}},editCell=function(t){var i=t.td,e=t.value,o=t.field,n=t.editType,s=t.rowObj,r=t.$tr,d=t.colIndex,l=this;if(0==t.colIndex)try{this.iconSpan="",this.iconSpan=$(i).find(".uf")[0].outerHTML}catch(t){}else this.iconSpan="";var t={};if(t.td=i,t.field=o,t.$tr=r,t.colIndex=d,l.newEditObj=t,"text"==n)"default"==this.options.editType?i.innerHTML='<div class="u-grid-content-td-div" style="position: relative; left: 0px;"><div class="eType-input"><input id="'+this.options.id+"_edit_field_"+o+'" type="text" value="'+e+'" field="'+o+'" style="width:100%;margin:0px;min-height:20px;font-size:12px;color:#444"></div></div>':i.innerHTML='<div class="u-grid-content-td-div" style="position: relative; left: 0px;"><div class="eType-input"><input id="'+this.options.id+"_edit_field_"+o+'" type="text" value="'+e+'" field="'+o+'"></div></div>',$("input",$(i)).on("blur",function(){l.editValueChange(o,this.value)});else if("function"==typeof n){var t={},a=$(".u-grid-content-td-div",$(i));if(a.removeClass("u-grid-content-td-div-over"),t.gridObj=this,t.element=a[0],"default"==this.options.editType){var h=t.element.offsetHeight,c='<div id="'+this.options.id+'_placeholder_div" class="u-grid-edit-placeholder-div" style="height:'+h+'px;"></div>';a[0].innerHTML=c,t.element=$("#"+this.options.id+"_placeholder_div")[0]}t.value=e,t.field=o,t.rowObj=s,n.call(this,t)}$("input",$(i)).off("keydown"),$("input",$(i)).on("keydown",function(t){if("form"==l.options.editType);else{t.keyCode;13!=t.keyCode&&9!=t.keyCode||(this.blur(),setTimeout(function(){l.nextEditShow()},100),u.stopEvent(t))}}),"default"==this.options.editType&&$("input:first",$(i)).focus()},nextEditShow=function(){var t=this.newEditObj,i=t.td,e=t.$tr,o=parseInt(t.colIndex)+1;if(0==$(i).next("td").length){var n=e.next("tr");if(!(n.length>0))return;e=n,o=0,e.click()}o=_getNextEditColIndex(this,o,e),this.editRowFun(e,o)},_getNextEditColIndex=function t(i,e,o){var n=i.gridCompColumnArr[e],s=!0,r=i.getTrIndex(o);if("function"==typeof i.options.onBeforeEditFun){var d={};d.gridObj=i,d.rowObj=i.dataSourceObj.rows[r],d.rowIndex=r,d.colIndex=e,d.$tr=o,i.options.onBeforeEditFun(d)||(s=!1)}return n.options.visible&&n.options.editable&&s?e:t(i,e+1,o)},editValueChange=function(t,i){this.eidtRowIndex>-1&&this.eidtRowIndex<this.dataSourceObj.rows.length&&this.updateValueAt(this.eidtRowIndex,t,i)},re_updateEditRowIndex=function(t,i,e){this.eidtRowIndex<0||("-"==t?i<this.eidtRowIndex?this.eidtRowIndex--:i==this.eidtRowIndex&&(this.eidtRowIndex=-1):"+"==t&&(void 0===e&&(e=1),i<=this.eidtRowIndex&&(this.eidtRowIndex+=e)))},re_updateValueAtEdit=function(t,i,e,o){this.eidtRowIndex==t&&("form"==this.options.editType||this.gridCompColumnArr[this.editColIndex].options.field==i&&(this.eidtRowIndex=-1),$("#"+this.options.id+"_edit_field_"+i).length>0&&("checkbox"==$("#"+this.options.id+"_edit_field_"+i)[0].type?$("#"+this.options.id+"_edit_field_"+i)[0].checked="Y"==e||"true"==e||!0===e:$("#"+this.options.id+"_edit_field_"+i)[0].value=e))},setEditType=function(t,i){this.getColumnByField(t).options.editType=i},setEditable=function(t){this.options.editable=t,this.setColumnEdit(),this.editClose()},setColumnEdit=function(){var t;for(t=0;t<this.gridCompColumnArr.length;t++)this.editFieldIcon(this.gridCompColumnArr[t]);for(t=0;t<this.gridCompColumnFixedArr.length;t++)this.editFieldIcon(this.gridCompColumnFixedArr[t])},editFieldIcon=function(t){var i=$(".u-grid-header-link[field="+t.options.field+"]"),e=i.find(".uf-fontselectioneditor");this.options.showEditIcon&&this.options.editable&&t.options.editable?(e||i.append('<i class="uf uf-fontselectioneditor"></i>'),i.removeClass("u-grid-hide-title-icon")):i.addClass("u-grid-hide-title-icon")},edit_initEventFun=function(){var t=this;$(document).on("click",function(i){if(t.options.editable&&"default"==t.options.editType){var e=$(i.target),o=!0;o=!($(i.target).closest(".u-grid-content-td-div").length>0)&&o;var n=t.options.customEditPanelClass;if(n){var s=n.split(",");$.each(s,function(){o=!(e.closest("."+this).length>0)&&o})}"grid-for-edit"==e.attr("role")&&(o=!1),0==e.parent().length&&(o=!1),o&&t.editClose()}}),u.on(document,"scroll",function(){"default"==t.options.editType&&(gridBrowser.isIE10||gridBrowser.isIPAD||t.editClose())}),$("div").on("scroll",function(){"default"==t.options.editType&&(gridBrowser.isIE10||gridBrowser.isIPAD||t.editClose())})},setGridEditType=function(t){this.options.editType=t},setGridEditTypeAndEditRow=function(t,i,e){this.options.editType=t;var o=$("#"+this.options.id+"_content_tbody"),n=$("tr:eq("+i+")",o);this.editRowFun(n,e)},editHeadTitleIcon=function(t){this.options.showEditIcon&&this.options.editable&&t.options.editable&&(t.options.title+='<i class="uf uf-fontselectioneditor"></i>')},eidtFunObj={hideEditMenu:re_hideEditMenu,clickFunEdit:re_clickFunEdit,editRowFun:editRowFun,editRowIndexFun:editRowIndexFun,editRow:editRow,editClose:re_editClose,editCell:editCell,nextEditShow:nextEditShow,editValueChange:editValueChange,updateEditRowIndex:re_updateEditRowIndex,updateValueAtEdit:re_updateValueAtEdit,setEditType:setEditType,setEditable:setEditable,setColumnEdit:setColumnEdit,editFieldIcon:editFieldIcon,setGridEditType:setGridEditType,setGridEditTypeAndEditRow:setGridEditTypeAndEditRow,editHeadTitleIcon:editHeadTitleIcon,edit_initEventFun:edit_initEventFun},editForm_initDefault=function(){this.defaults=$.extend(!0,{},this.defaults,{noneEditableFormShow:!0})},editForm_setRequired=function(t,i){var e=this;$.each(this.gridCompColumnArr,function(o){this.options.field==t&&(this.options.required=i,i?$("#"+e.options.id+"_edit_"+this.options.field).parent().find(".u-grid-edit-mustFlag").show():$("#"+e.options.id+"_edit_"+this.options.field).parent().find(".u-grid-edit-mustFlag").hide())})},re_editorRowChangeFun=function(){if($("#"+this.options.id+"_edit_form").length>0){var t=$("#"+this.options.id+"_edit_form")[0].offsetHeight;$("#"+this.options.id+"_numCol_edit").css("height",t),$("#"+this.options.id+"_multiSelect_edit").css("height",t)}},formEditCell=function(t,i,e,o,n){var s=e+"";s.lengthb()>28&&(s=s.substrCH(26)+"...");var r='<div class="u-grid-edit-whole-div"><div class="u-grid-edit-label"><div title="'+e+'" style="color:'+n+'">'+s+'<span style="color:red;'+(o?"":"display: none")+'" class="u-grid-edit-mustFlag">*</span></div></div>';return r+='<div id="'+this.options.id+"_edit_"+i+'" class="u-grid-edit-div"></div>',r+="</div>"},editFromFunObj={editForm_initDefault:editForm_initDefault,editForm_setRequired:editForm_setRequired,editorRowChangeFun:re_editorRowChangeFun,formEditCell:formEditCell},re_initGridCompFixedColumn=function(){var t=this,i=[];$.each(this.gridCompColumnArr,function(i){1==this.options.fixed&&t.gridCompColumnFixedArr.push(this)}),$.each(this.gridCompColumnFixedArr,function(e){1!=this.options.fixed&&(t.gridCompColumnArr.push(this),i.push(this))}),$.each(i,function(i){for(var i=t.gridCompColumnFixedArr.length;i>-1;i--)if(this==t.gridCompColumnFixedArr[i]){t.gridCompColumnFixedArr.splice(i,1);break}}),$.each(this.gridCompColumnFixedArr,function(i){for(var i=t.gridCompColumnArr.length;i>-1;i--)if(t.gridCompColumnArr[i]==this){t.gridCompColumnArr.splice(i,1);break}})},fixed_columnsVisibleFun=function(){var t=this,i=0;$.each(this.gridCompColumnFixedArr,function(){this.options.visible&&(i+=parseInt(this.options.width),this.firstColumn=t.firstColumn,t.firstColumn=!1)}),this.fixedRealWidth=i,this.fixedWidth=i},re_createHeaderTableFixed=function(){return this.createHeaderTable("fixed")},re_createContentTableFixed=function(){return this.createContentTable("fixed")},re_createContentOneRowFixed=function(t){return this.createContentOneRow(t,"fixed")},re_widthChangeGridFunFixed=function(t){this.fixedRealWidth>t?this.fixedWidth=t:this.fixedWidth=this.fixedRealWidth},setColumnFixed=function(t,i){this.getColumnByField(t).options.fixed=i,this.initGridCompFixedColumn(),this.repaintDivs()},fixFunObj={initGridCompFixedColumn:re_initGridCompFixedColumn,fixed_columnsVisibleFun:fixed_columnsVisibleFun,createHeaderTableFixed:re_createHeaderTableFixed,createContentTableFixed:re_createContentTableFixed,createContentOneRowFixed:re_createContentOneRowFixed,widthChangeGridFunFixed:re_widthChangeGridFunFixed,setColumnFixed:setColumnFixed},createFromDivs=function(){if(!this.createFormFlag){var t='<div id="'+this.options.id+'_form" class="u-grid-form">';t+=this.createFromContent(),$("#"+this.options.id)[0].insertAdjacentHTML("afterBegin",t),this.createFormFlag=!0}},createFromContent=function(){var t='<div class="u-grid-form-content" id="'+this.options.id+'_form_content" class="u-grid-content">';return t+='<table role="grid" id="'+this.options.id+'_form_content_table">',t+=this.createFormContentRows(),t+="</table>"},createFormContentRows=function(){var t=this,i="";return this.dataSourceObj.rows&&(i+='<tbody role="rowgroup" id="'+this.options.id+'_form_content_tbody">',$.each(this.dataSourceObj.rows,function(){i+='<tr role="row"><td role="rowcell">';var e=this.value;$.each(t.gridCompColumnArr,function(){var t=this.options.field,o=this.options.title,n=$(e).attr(t);i+="<div>"+o+":</div>",i+="<div>"+n+"</div>"}),i+="</td></tr>"}),i+="</tbody>"),i},widthChangeFormFun=function(){this.createFromDivs(),$("#"+this.options.id+"_grid").css("display","none"),$("#"+this.options.id+"_form").css("display","block"),this.showType="form","function"==typeof this.options.afterCreate&&this.options.afterCreate.call(this)},formShowFunOjb={createFromDivs:createFromDivs,createFromContent:createFromContent,createFormContentRows:createFormContentRows,widthChangeFormFun:widthChangeFormFun},re_resetThVariableHeaderLevel=function(){var t=this,i=this.options.maxHeaderLevel,e=[];$("#"+this.options.id+"_header_table th",this.$ele).each(function(i){var o=t.gridCompColumnArr[i],n=o.options.field,s=0;o.options.visible&&(s=parseInt(o.options.width));var r={field:n,width:s};e.push(r)});for(var o=this.getColumnByVisibleIndex(0).options.field,n=0;n<this.gridCompLevelColumn.length;n++){var s=this.gridCompLevelColumn[n],r=s.field,d=s.title,l=s.startField,a=s.endField;if(l&&a){var h=$("th[field="+l+"]",this.$ele.find("#"+this.options.id+"_header_thead")),u=' style="',c="",p="",m=s.headerLevel;u+="top:"+(parseInt(i)-parseInt(m))*this.baseHeaderHeight+"px;z-index:"+m+";";for(var f=0,g=!1,w=0;w<e.length;w++){var v=e[w],C=v.field;if((C==l||g)&&(g=!0,f+=v.width,C==a))break}u+="width:"+f+"px;",u+='" ',o==l&&(c+=" grid-no-left-border "),i==m&&(c+=" grid-max-level-div "),this.options.headerHeight&&(p='style="height:'+this.options.headerHeight+"px;line-height:"+this.options.headerHeight+'px;"');var _='<div id="'+this.options.id+r+'" class="u-gird-parent '+c+'" '+u+'><div class="u-grid-header-link" '+p+' title="'+d+'">'+d+"</div></div>";h[0].insertAdjacentHTML("afterBegin",_)}}},re_initGridCompColumnHeaderLevelFun=function(t){if(t.headerLevel>1){this.gridCompLevelColumn.push(t);var i=this.gridCompColumnArr.length;this.gridCompColumnArr.length=i-1,this.basicGridCompColumnArr&&this.basicGridCompColumnArr.length>0&&(this.basicGridCompColumnArr.length=i-1)}},getLevelTitleByField=function(t){for(var i=0;i<this.gridCompLevelColumn.length;i++){if(this.gridCompLevelColumn[i].field==t)return this.gridCompLevelColumn[i].title}return""},headerLevelFunObj={resetThVariableHeaderLevel:re_resetThVariableHeaderLevel,initGridCompColumnHeaderLevelFun:re_initGridCompColumnHeaderLevelFun,getLevelTitleByField:getLevelTitleByField},re_initGridCompColumnLoacl=function(){var t=this,i=this.getGridCompColumnArrFromLocal();null!=i&&(this.gridCompColumnArr=i,$.each(this.gridCompColumnArr,function(){for(var i=this.options.field,e=0;e<t.options.columns.length;e++){var o=t.options.columns[e];if(o.field==i){var n=$.extend({},o,this.options);this.options=n,this.options.realWidth=this.options.width;break}}}))},getLocalData=function getLocalData(){if(!this.options.needLocalStorage)return null;if(null==window.localStorage)return null;if(null!=this.$sd_storageData)return this.$sd_storageData;if(null==window.localStorage.getItem(this.localStorageId))try{window.localStorage.setItem(this.localStorageId,"{}")}catch(t){return null}
var storageDataStr=window.localStorage.getItem(this.localStorageId);return"undefined"==typeof JSON?this.$sd_storageData=eval("("+storageDataStr+")"):this.$sd_storageData=JSON.parse(storageDataStr),this.$sd_storageData},saveLocalData=function(){if(!this.options.needLocalStorage)return null;var t=this;this.saveSettimeout&&clearTimeout(this.saveSettimeout),this.saveSettimeout=setTimeout(function(){if(null!=t.$sd_storageData&&null!=window.localStorage){var i=JSON.stringify(t.$sd_storageData);try{window.localStorage.setItem(t.localStorageId,i)}catch(t){}}},200)},clearLocalData=function(){if(!this.options.needLocalStorage)return null;this.saveSettimeout&&clearTimeout(this.saveSettimeout),window.localStorage.setItem(this.localStorageId,"{}"),this.$sd_storageData={}},saveGridCompColumnArrToLocal=function(){if(!this.options.needLocalStorage)return null;this.getLocalData().gridCompColumnArr=this.gridCompColumnArr.concat(this.gridCompColumnFixedArr),this.saveLocalData()},getGridCompColumnArrFromLocal=function(){if(!this.options.needLocalStorage)return null;var t=this.getLocalData();return null==t?null:null==t.gridCompColumnArr?null:t.gridCompColumnArr},localStorageFunObj={initGridCompColumnLoacl:re_initGridCompColumnLoacl,getLocalData:getLocalData,saveLocalData:saveLocalData,clearLocalData:clearLocalData,saveGridCompColumnArrToLocal:saveGridCompColumnArrToLocal,getGridCompColumnArrFromLocal:getGridCompColumnArrFromLocal},re_initGridHiddenLevelColumn=function(){if(this.options.overWidthHiddenColumn){this.gridCompHiddenLevelColumnArr=this.gridCompColumnArr.slice(0),this.gridCompHiddenLevelColumnArr.sort(function(t,i){return t.options.hiddenLevel>i.options.hiddenLevel?-1:1})}},re_widthChangeGridFunOverWidthHidden=function(){if(this.options.overWidthHiddenColumn){this.lastVisibleColumn.options.width=this.lastVisibleColumn.options.realWidth;var t=parseInt(this.wholeWidth)-parseInt(this.leftW),i=parseInt(this.fixedWidth)+parseInt(this.contentRealWidth);if(i>t){for(var e=0;e<this.gridCompHiddenLevelColumnArr.length;e++){var o=this.gridCompHiddenLevelColumnArr[e];if(o.options.visible&&(o.options.visible=!1,i=parseInt(i)-parseInt(o.options.width)),!(i>t))break}this.columnsVisibleFun()}}},overWidthHiddenFunObj={initGridHiddenLevelColumn:re_initGridHiddenLevelColumn,widthChangeGridFunOverWidthHidden:re_widthChangeGridFunOverWidthHidden},re_createContentRowsSumRow=function(t){var i="";return this.options.showSumRow&&this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0&&(i+=this.createSumRow(t)),i},re_createContentSumRow=function(t){return""},createSumRow=function(t){if(this.options.showSumRow){var i,e,o=this;"fixed"==t?(i="fixed_",e=this.gridCompColumnFixedArr):(i="",e=this.gridCompColumnArr);var n=parseInt(this.wholeHeight)-this.exceptContentHeight-48-this.scrollBarHeight;n=n>0?n:0;var s='<tr role="sumrow" class="u-grid-content-sum-row" id="'+this.options.id+"_content_"+i+'sum_row" style="top:'+n+'px;">';return $.each(e,function(){var t=this.options.field,i=this.options.precision,e=this.options.dataType,n=o.dataSourceObj.getSumValue(t,this,o);if("float"==e){var r={};r.value=n,r.precision=i||2,n=o.DicimalFormater(r)}var d="";this.options.visible?o.options.rowHeight&&(d+='style="height:'+o.options.rowHeight+"px;line-height:"+o.options.rowHeight+'px;"'):(d='style="display:none;',o.options.rowHeight&&(d+="height:"+o.options.rowHeight+"px;line-height:"+o.options.rowHeight+"px;"),d+='"'),s+='<td role="sumrowcell" title="'+n+'" '+d+">",this.firstColumn&&(s+='<div class="u-gird-centent-sum-div"><span>'+o.transMap.ml_sum+"</span></div>");var l="";"integer"!=this.options.dataType&&"float"!=this.options.dataType||(l='style="text-align: right;"'),s+='<div class="u-grid-content-td-div" '+l+'><span value="'+n+'">'+n+"</span></div></td>"}),s+="</tr>"}},createSumRowForIE=function(t,i){if(this.options.showSumRow){var e,o,n=this;"fixed"==i?(e="fixed_",o=this.gridCompColumnFixedArr):(e="",o=this.gridCompColumnArr);var s=parseInt(this.wholeHeight)-this.exceptContentHeight-48-this.scrollBarHeight;s=s>0?s:0;var r=t.insertRow();r.role="sumrow",r.className="u-grid-content-sum-row",r.id=this.options.id+"_content_"+e+"sum_row",r.style.top=s+"px",$.each(o,function(){var t=this.options.field,i=this.options.precision,e=this.options.dataType,o=n.dataSourceObj.getSumValue(t,this,n);if("float"==e){var s={};s.value=o,s.precision=i||2,o=n.DicimalFormater(s)}var d=r.insertCell();d.role="sumrowcell",d.title=o,n.options.sumRowHeight&&(d.style.height=n.options.sumRowHeight+"px",d.style.lineHeight=n.options.sumRowHeight+"px");var l="";"integer"!=this.options.dataType&&"float"!=this.options.dataType||(l='style="text-align: right;"');var a='<div class="u-grid-content-td-div" '+l+">";this.firstColumn&&(a+='<div class="u-gird-centent-sum-div"><span>'+n.transMap.ml_sum+"</span></div>"),a+='<span value="'+o+'">'+o+"</span></div>",d.insertAdjacentHTML("afterBegin",a)})}},re_repairSumRow=function(){var t=this;this.re_repairSumRowSetTimeout&&clearTimeout(this.re_repairSumRowSetTimeout),this.re_repairSumRowSetTimeout=setTimeout(function(){re_repairSumRowFun.call(t)},100)},re_repairSumRowFun=function(){if(this.options.showSumRow){if(this.options.sumRowFixed)if(this.options.sumRowFirst){$("#"+this.options.id+"_noScroll_begin_table tbody .u-grid-content-sum-row").remove(),$("#"+this.options.id+"_noScroll_fixed_begin_table tbody .u-grid-content-sum-row").remove();try{if(this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0){$("#"+this.options.id+"_grid .u-grid-noScroll-left").remove();if((this.options.multiSelect||this.options.showNumCol)&&this.options.sumRowFirst&&this.options.sumRowFixed){var t='<div id="'+this.options.id+'_noScroll_left" class="u-grid-noScroll-left" style="width:'+this.leftW+"px;height:"+this.noScrollHeight+'px;">';t+="</div>",$("#"+this.options.id+"_grid .u-grid-noScroll-wrap")[0].insertAdjacentHTML("afterBegin",t)}var t=this.createSumRow();$("#"+this.options.id+"_noScroll_begin_table tbody")[0].insertAdjacentHTML("afterBegin",t);var t=this.createSumRow("fixed");$("#"+this.options.id+"_noScroll_fixed_begin_table tbody")[0].insertAdjacentHTML("afterBegin",t)}}catch(t){var i=$("#"+this.options.id+"_noScroll_begin_table")[0],e=$("#"+this.options.id+"_noScroll_fixed_begin_table")[0];this.createSumRowForIE(i),this.createSumRowForIE(e,"fixed")}}else{$("#"+this.options.id+"_noScroll_end_table tbody .u-grid-content-sum-row").remove(),$("#"+this.options.id+"_noScroll_fixed_end_table tbody .u-grid-content-sum-row").remove();try{if(this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0){var t=this.createSumRow();$("#"+this.options.id+"_noScroll_end_table tbody")[0].insertAdjacentHTML("afterBegin",t);var t=this.createSumRow("fixed");$("#"+this.options.id+"_noScroll_fixed_end_table tbody")[0].insertAdjacentHTML("afterBegin",t)}}catch(t){var i=$("#"+this.options.id+"_noScroll_end_table")[0],e=$("#"+this.options.id+"_noScroll_fixed_end_table")[0];this.createSumRowForIE(i),this.createSumRowForIE(e,"fixed")}}else{$("#"+this.options.id+"_content_div tbody .u-grid-content-sum-row").remove(),$("#"+this.options.id+"_content_fixed_div tbody .u-grid-content-sum-row").remove();try{if(this.dataSourceObj.rows&&this.dataSourceObj.rows.length>0){var t=this.createSumRow();this.options.sumRowFirst?$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("afterBegin",t):$("#"+this.options.id+"_content_div tbody")[0].insertAdjacentHTML("beforeEnd",t);var t=this.createSumRow("fixed");$("#"+this.options.id+"_content_fixed_div tbody")[0]&&(this.options.sumRowFirst?$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("afterBegin",t):$("#"+this.options.id+"_content_fixed_div tbody")[0].insertAdjacentHTML("beforeEnd",t))}}catch(t){var i=$("#"+this.options.id+"_content_div table")[0],e=$("#"+this.options.id+"_content_fixed_div table")[0];this.createSumRowForIE(i),this.createSumRowForIE(e,"fixed")}}this.renderSumRow()}},renderSumRow=function(){var t=this;$.each(this.gridCompColumnFixedArr,function(i){var e=this.options.sumCol,o=this.options.sumRenderType;if(e){var n=$("#"+t.options.id+"_content_fixed_sum_row").find("td").eq(i).find("span"),s=n[n.length-1];if(s)if("function"==typeof o){var r=$(s).attr("value"),d={};d.value=r,d.element=s,d.gridObj=t,d.gridCompColumn=this,o.call(t,d)}else"integer"!=dataType&&"float"!=dataType||(s.style.textAlign="right")}}),$.each(this.gridCompColumnArr,function(i){var e=this.options.sumCol,o=this.options.dataType,n=this.options.sumRenderType;if(e){var s=$("#"+t.options.id+"_content_sum_row").find("td").eq(i).find("span"),r=s[s.length-1];if(r)if("function"==typeof n){var d=$(r).attr("value"),l={};l.value=d,l.element=r,l.gridObj=t,l.gridCompColumn=this,n.call(t,l)}else"integer"!=o&&"float"!=o||(r.style.textAlign="right")}})},re_renderTypeSumRow=function(t,i,e,o,n){var s=this,r=t.options.sumCol,d=t.options.sumRenderType,l=t.options.dataType,a=!0===n?"fixed_":"";if(r){var h=$("#"+this.options.id+"_content_"+a+"sum_row").find("td").eq(i).find("span"),u=h[h.length-1];if(u)if("function"==typeof d){var c=$(u).attr("value"),p={};p.value=c,p.element=u,p.gridObj=s,p.gridCompColumn=t,d.call(s,p)}else"integer"!=l&&"float"!=l||(u.style.textAlign="right")}};window.maxSumRender=function(t){var i,e=t.gridObj,o=t.gridCompColumn,n=o.options.field,s=t.element;if($.each(e.dataSourceObj.rows,function(t){var s=$(this.value).attr(n);s="Int"==o.options.dataType?e.getInt(s,0):e.getFloat(s,0),void 0===i?i=s:s>i&&(i=s)}),"Float"==o.options.dataType&&o.options.precision){var r={};r.value=i,r.precision=o.options.precision,i=e.DicimalFormater(r)}s.innerHTML=i+""},window.minSumRender=function(t){var i,e=t.gridObj,o=t.gridCompColumn,n=o.options.field,s=t.element;if($.each(e.dataSourceObj.rows,function(t){var s=$(this.value).attr(n);s="Int"==o.options.dataType?e.getInt(s,0):e.getFloat(s,0),void 0===i?i=s:s<i&&(i=s)}),"Float"==o.options.dataType&&o.options.precision){var r={};r.value=i,r.precision=o.options.precision,i=e.DicimalFormater(r)}s.innerHTML=i+""},window.avgSumRender=function(t){var i=t.value,e=t.gridObj,o=t.gridCompColumn,n=t.element,s=e.dataSourceObj.rows.length,r=i/s;if("Float"==o.options.dataType&&o.options.precision){var d={};d.value=r,d.precision=o.options.precision,r=e.DicimalFormater(d)}n.innerHTML=r+""};var sumRowFunObj={createContentRowsSumRow:re_createContentRowsSumRow,createContentSumRow:re_createContentSumRow,createSumRow:createSumRow,createSumRowForIE:createSumRowForIE,repairSumRow:re_repairSumRow,renderSumRow:renderSumRow,renderTypeSumRow:re_renderTypeSumRow},swap_initEventFun=function(){var t=this;$("#"+this.options.id).on("mousedown",function(i){if($(i.target).closest("#"+t.options.id+"_header").length>0){var e=$(i.target).closest("th")[0];t.options.canSwap&&e&&t.swapColumnStart(i,e),i.preventDefault()}else $(i.target).closest("#"+t.options.id+"_content").length}),$("#"+this.options.id).on("mousemove",function(i){t.mouseMoveX=i.clientX,t.mouseMoveY=i.clientY,(t.mouseMoveX!=t.mouseDownX||t.mouseDownY!=t.mouseMoveY)&&"mouseDownX"!=t.mouseDownX&&t.options.canSwap&&t.swapColumnEle&&(t.swapColumnFlag=!0),t.swapColumnFun(i)}),$("#"+this.options.id+"_top").on("mousemove",function(i){t.mouseMoveX=i.clientX,t.mouseMoveY=i.clientY,(t.mouseMoveX!=t.mouseDownX||t.mouseDownY!=t.mouseMoveY)&&"mouseDownX"!=t.mouseDownX&&t.options.canSwap&&t.swapColumnEle&&(t.swapColumnFlag=!0),t.swapColumnFun(i),i.stopPropagation()}),$("#"+this.options.id).on("mouseup",function(i){t.mouseUpX=i.clientX,t.mouseUpY=i.clientY,t.swapColumnEnd(i),t.mouseUpX="mouseUpX",t.mouseUpY="mouseUpY",t.mouseDownX="mouseDownX",t.mouseDownY="mouseDownY",t.mouseMoveX="mouseMoveX",t.mouseMoveY="mouseMoveY"}),$("#"+this.options.id+"_top").on("mouseup",function(i){t.mouseUpX=i.clientX,t.mouseUpY=i.clientY,t.swapColumnEnd(i),t.mouseUpX="mouseUpX",t.mouseUpY="mouseUpY",t.mouseDownX="mouseDownX",t.mouseDownY="mouseDownY",t.mouseMoveX="mouseMoveX",t.mouseMoveY="mouseMoveY"})},swap_initGridEventFun=function(){},swapColumnStart=function(t,i){this.options.canSwap&&(this.swapColumnEle=i,this.swapColumnStartX=t.clientX,this.swapColumnStartY=t.clientY)},swapColumnFun=function(t){if(this.options.canSwap){var i=this;if(this.swapColumnFlag){var e=this.swapColumnEle;if(!e)return;var o=$(e);if(!e.gridCompColumn)return;var n=e.gridCompColumn;if(0==$("#"+this.options.id+"_clue").length){var s=$('<div class="u-grid u-grid-header-drag-clue" id="'+this.options.id+'_clue" />').css({width:e.scrollWidth+"px",left:e.attrLeftTotalWidth-i.scrollLeft+i.leftW+i.fixedWidth+"px",top:"0px",paddingLeft:o.css("paddingLeft"),paddingRight:o.css("paddingRight"),lineHeight:o.height()+"px",paddingTop:o.css("paddingTop"),paddingBottom:o.css("paddingBottom")}).html(n.options.title||n.options.field).prepend('<span class="uf uf-bancirclesymbol u-grid-header-drag-status" />');try{$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",s[0])}catch(t){$("#"+this.options.id)[0].insertBefore(s[0],$("#"+this.options.id)[0].firstChild)}s.on("mousemove",function(){t.stopPropagation()})}this.swapColumnEndX=t.clientX,this.swapColumnEndY=t.clientY;var r=this.swapColumnEndX-this.swapColumnStartX,d=this.swapColumnEndY-this.swapColumnStartY;if($("#"+this.options.id+"_clue").css({left:e.attrLeftTotalWidth+r-i.scrollLeft+i.leftW+i.fixedWidth+"px",top:d+"px"}),0==$("#"+this.options.id+"_swap_top").length){var s=$('<span class="uf uf-triangle-down u-grid-header-swap-tip-span"  id="'+this.options.id+'_swap_top"/>');s.css({top:o.height()-6+"px"});var l=$('<span class="uf uf-triangle-up u-grid-header-swap-tip-span" id="'+this.options.id+'_swap_down" />');l.css({top:"6px"});try{$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",s[0]),$("#"+this.options.id)[0].insertAdjacentElement("afterBegin",l[0])}catch(t){$("#"+this.options.id)[0].insertBefore(s[0],$("#"+this.options.id)[0].firstChild),$("#"+this.options.id)[0].insertBefore(l[0],$("#"+this.options.id)[0].firstChild)}}this.canSwap=!1,$("#"+this.options.id+"_header_table th").each(function(e){var o=$(this).offset().left,n=o+parseInt(this.attrWidth);if(0==e&&t.clientX<o)i.swapColumnEle!=this&&(i.swapToColumnEle="LeftEle",$("#"+i.options.id+"_swap_top").css({left:-i.scrollLeft-3+i.leftW+i.fixedWidth+"px",display:"block"}),$("#"+i.options.id+"_swap_down").css({left:-i.scrollLeft-3+i.leftW+i.fixedWidth+"px",display:"block"})),i.canSwap=!0;else if(o<t.clientX&&t.clientX<n&&i.swapColumnEle!=this&&parseInt($(this).attr("index"))+1!=parseInt($(i.swapColumnEle).attr("index")))return i.swapToColumnEle!=this&&(i.swapToColumnEle=this,$("#"+i.options.id+"_swap_top").css({left:this.attrRightTotalWidth-i.scrollLeft-3+i.leftW+i.fixedWidth+"px",display:"block"}),$("#"+i.options.id+"_swap_down").css({left:this.attrRightTotalWidth-i.scrollLeft-3+i.leftW+i.fixedWidth+"px",display:"block"})),i.canSwap=!0,!1}),this.canSwap?$(".u-grid-header-drag-status").removeClass("uf-bancirclesymbol").addClass("uf-plussigninablackcircle"):($("#"+this.options.id+"_swap_top").css("display","none"),$("#"+this.options.id+"_swap_down").css("display","none"),$(".u-grid-header-drag-status").removeClass("uf-plussigninablackcircle").addClass("uf-bancirclesymbol"),this.swapToColumnEle=null),$("#"+this.options.id+"_top").css("display","block")}}},swapColumnEnd=function(t){if(this.options.canSwap){if(this.swapColumnFlag){if(this.swapToColumnEle){var i=this.swapColumnEle,e=this.swapToColumnEle,o=$(i).attr("index"),n=$(e).attr("index"),s=this.gridCompColumnArr[o];this.gridCompColumnArr.splice(parseInt(n)+1,0,s),parseInt(o)<parseInt(n)?this.gridCompColumnArr.splice(parseInt(o),1):this.gridCompColumnArr.splice(parseInt(o)+1,1),this.saveGridCompColumnArrToLocal(),this.repaintGridDivs(),this.resetColumnWidthByRealWidth()}$("#"+this.options.id+"_clue").remove(),$("#"+this.options.id+"_swap_top").css("display","none"),$("#"+this.options.id+"_swap_down").css("display","none")}this.swapColumnEle=null,this.swapColumnFlag=!1,$("#"+this.options.id+"_top").css("display","none")}},swapFunObj={swap_initEventFun:swap_initEventFun,swap_initGridEventFun:swap_initGridEventFun,swapColumnStart:swapColumnStart,swapColumnFun:swapColumnFun,swapColumnEnd:swapColumnEnd},rowDrag_initGridEventFun=function(){var t=this;$("#"+this.options.id+"_content_tbody").on("mousedown",function(i){var e=$(i.target).closest("tr"),o=$(i.target).closest("tr").hasClass("grid_edit_form_tr");if(e.length>0&&!o){var n=$(i.target).closest("tr")[0];t.options.canRowDrag&&t.rowDragStart(i,n)}}),$("#"+this.options.id+"_content_tbody").on("mousemove",function(i){t.mouseMoveX=i.clientX,t.mouseMoveY=i.clientY,t.rowDragEle&&(t.mouseMoveX!=t.rowDragStartX||t.mouseMoveY!=t.rowDragStartY)&&t.options.canRowDrag&&(t.rowDragFlag=!0,t.rowDragFun(i))}),$("#"+this.options.id+"_content_tbody").on("mouseup",function(i){t.mouseUpX=i.clientX,t.mouseUpY=i.clientY,t.rowDragEnd(i)})},rowDragStart=function(t,i){var e=this;this.options.canRowDrag&&(this.rowDragStartX=t.clientX,this.rowDragStartY=t.clientY,this.rowDragEle=i,$("#"+this.options.id+"_content_tbody").find("tr").each(function(t){if($(this).is(e.rowDragEle))return e.rowDragStartIndex=t,!1}))},rowDragFun=function(t){if(this.options.canRowDrag&&this.rowDragFlag){this.rowDragEndX=t.clientX,this.rowDragEndY=t.clientY;var i=(this.rowDragEndX,this.rowDragStartX,this.rowDragEndY-this.rowDragStartY),e=this.rowDragEle.clientHeight,o=parseInt(i/e);this.dragdirection=o<0?-1:1,this.rowDragEndIndex=this.rowDragStartIndex+o,this.rowDragEndIndex<0&&(this.rowDragEndIndex=0),this.rowDragEndIndex!=this.rowDragStartIndex&&($("#"+this.options.id+"_content_tbody").find("tr td").removeClass("u-grid-drag-icon"),$("#"+this.options.id+"_content_tbody").find("tr").eq(this.rowDragEndIndex).find("td").first().addClass("u-grid-drag-icon"))}},rowDragEnd=function(t){var i;if(this.options.canRowDrag){if(this.rowDragFlag&&this.rowDragEndIndex!=this.rowDragStartIndex){i=this.dataSourceObj.rows[this.rowDragStartIndex],$("#"+this.options.id+"_content_tbody").find("tr td").removeClass("u-grid-drag-icon"),this.dragdirection<0?($("#"+this.options.id+"_content_tbody").find("tr").eq(this.rowDragEndIndex).before(this.rowDragEle),this.dataSourceObj.rows.splice(this.rowDragStartIndex,1),this.dataSourceObj.rows.splice(this.rowDragEndIndex,0,i)):(this.dataSourceObj.rows.splice(this.rowDragStartIndex,1),this.rowDragEndIndex>=this.dataSourceObj.rows.length?($("#"+this.options.id+"_content_tbody").append(this.rowDragEle),this.dataSourceObj.rows.splice(this.rowDragEndIndex+1,0,i)):($("#"+this.options.id+"_content_tbody").find("tr").eq(this.rowDragEndIndex+1).before(this.rowDragEle),this.dataSourceObj.rows.splice(this.rowDragEndIndex,0,i)));var e=[];e=e.concat(this.getSelectRows()),this.setAllRowUnSelect(),this.options.multiSelect&&$("#"+this.options.id+"_content_multiSelect").find(".u-grid-content-sel-row").removeClass("u-grid-content-sel-row"),this.options.showNumCol&&$("#"+this.options.id+"_content_numCol").find(".u-grid-content-sel-row").removeClass("u-grid-content-sel-row");for(var o=0;o<e.length;o++){var n=e[o],s=this.getRowIndexByValue("$_#_@_id",n["$_#_@_id"]);this.setRowSelect(s)}}this.rowDragFlag=!1,this.rowDragEle=void 0}},setRowDrag=function(t){this.options.canRowDrag=t},rowDragFunObj={rowDrag_initGridEventFun:rowDrag_initGridEventFun,rowDragStart:rowDragStart,rowDragFun:rowDragFun,rowDragEnd:rowDragEnd,setRowDrag:setRowDrag},createContentGroupRows$1=function(t){var i="",e=this;return this.options.groupField&&this.dataSourceObj.groupRows&&this.dataSourceObj.groupRows.length>0&&$.each(this.dataSourceObj.groupRows,function(o){$.each(this.rows,function(){i+=e.createContentOneRow(this,t)}),e.options.groupSumRow&&(i+=e.createContentGroupSumRow(this,t))}),i},createContentLeftMultiSelectGroupRows$1=function(){var t="",i=this;return this.options.groupField&&this.dataSourceObj.groupRows&&this.dataSourceObj.groupRows.length>0&&$.each(this.dataSourceObj.groupRows,function(e){this.rows&&this.rows.length>0&&($.each(this.rows,function(){t+=i.createContentLeftMultiSelectRow(this)}),i.options.groupSumRow&&(t+=i.createContentLetGroupSumRow("multiSelect",this.value)))}),t},createContentLeftNumColGroupRows$1=function(){var t="",i=this,e=0;return this.options.groupField&&this.dataSourceObj.groupRows&&this.dataSourceObj.groupRows.length>0&&$.each(this.dataSourceObj.groupRows,function(o){this.rows&&this.rows.length>0&&($.each(this.rows,function(){t+=i.createContentLeftNumColRow(e),e++}),i.options.groupSumRow&&(t+=i.createContentLetGroupSumRow("numCol",this.value)))}),t},re_getGroupIndex=function(t,i,e){var o=this.options.groupField,n=this;if(o){var s=this.getString($(t).attr(o),""),r=-1;return this.dataSourceObj.addOneRowGroup(e),$.each(this.dataSourceObj.rows,function(t){var i=this,e=n.getString($(i.value).attr(o),"");if(s==e)r=t;else if(r>-1)return!1}),r>-1?r+1:r=this.dataSourceObj.rows.length}return i},getGroupRowByGroupValue=function(t){var i;if(this.dataSourceObj.groupRows&&this.dataSourceObj.groupRows.length>0)return $.each(this.dataSourceObj.groupRows,function(){if(this.value==t)return i=this,!1}),i},deleteOneRowGroup=function(t){var i=this.options.groupField,e=t.value[i],o=this.getGroupRowByGroupValue(e);if(o){var n=o.rows.indexOf(t);if(o.rows.splice(n,1),0==o.rows.length){var s=this.dataSourceObj.groupRows.indexOf(o);this.dataSourceObj.groupRows.splice(s,1)}}},resetGroupFieldTd$1=function(t){var i=$("#"+this.options.id+"_content_table").find("td[realValue="+t+"]"),e=i.length;i.addClass("u-grid-content-td-group-field").addClass("no-text").removeClass("group-last"),$(i[e-1]).addClass("group-last"),$(i[0]).css("line-height",e*this.options.rowHeight+"px").removeClass("no-text")},groupFunObj={createContentGroupRows:createContentGroupRows$1,createContentLeftMultiSelectGroupRows:createContentLeftMultiSelectGroupRows$1,createContentLeftNumColGroupRows:createContentLeftNumColGroupRows$1,getGroupIndex:re_getGroupIndex,getGroupRowByGroupValue:getGroupRowByGroupValue,deleteOneRowGroup:deleteOneRowGroup,resetGroupFieldTd:resetGroupFieldTd$1},createContentGroupSumRow=function(t,i){if(this.options.groupSumRow){var e,o=t.value;e="fixed"==i?"fixed_":"";var n='<tr role="groupsumrow" groupValue="'+o+'" class="u-grid-content-group-sum-row" id="'+this.options.id+"_content_"+e+"group_sum_row_"+o+'">';return n+=createContentGroupSumRowTd.call(this,t,i),n+="</tr>"}},createContentGroupSumRowTd=function(t,i){var e,o="",n=this;return e="fixed"==i?this.gridCompColumnFixedArr:this.gridCompColumnArr,$.each(e,function(){var i=this.options.field,e=this.options.precision,s=this.options.dataType,r=n.dataSourceObj.getGroupSumValue(i,this,t);if("float"==s){var d={};d.value=r,d.precision=e||2,r=n.DicimalFormater(d)}var l="";this.options.visible?n.options.rowHeight&&(l+='style="height:'+n.options.rowHeight+"px;line-height:"+n.options.rowHeight+'px;"'):(l='style="display:none;',n.options.rowHeight&&(l+="height:"+n.options.rowHeight+"px;line-height:"+n.options.rowHeight+"px;"),l+='"'),o+='<td role="groupsumrowcell"  title="'+r+'" '+l+">",this.firstColumn&&(o+='<div class="u-gird-centent-group-sum-div"><span>'+n.transMap.ml_group_sum+"</span></div>");var a="";"integer"!=this.options.dataType&&"float"!=this.options.dataType||(a='style="text-align: right;"'),o+='<div class="u-grid-content-td-div" '+a+'><span value="'+r+'">'+r+"</span></div></td>"}),o},createContentLetGroupSumRow=function(t,i){var e,o="";"multiSelect"==t&&(e=this.multiSelectWidth),"numCol"==t&&(e=this.numWidth);var n="width:"+e+"px;";return this.options.needResetHeight||(o="height:"+(this.options.rowHeight+1)+"px;"),'<span groupValue="'+i+'" class="u-grid-content-group-sum-left" style=" '+n+o+'"></span>'},repairGroupSumRow$1=function(t){if(this.options.groupSumRow){var i=this,e=this.options.groupField,o=t.value[e];this.repairGroupSumRowArr||(this.repairGroupSumRowArr=[]),this.repairGroupSumRowArr.indexOf(o)<0&&this.repairGroupSumRowArr.push(o),this.re_repairGroupSumRowSetTimeout&&clearTimeout(this.re_repairGroupSumRowSetTimeout),this.re_repairGroupSumRowSetTimeout=setTimeout(function(){repairGroupSumRowFun.call(i)},200)}},repairGroupSumRowFun=function(){var t=this;this.repairGroupSumRowArr&&this.repairGroupSumRowArr.length>0&&this.options.groupSumRow&&($.each(this.repairGroupSumRowArr,function(){var i=this,e=t.getGroupRowByGroupValue(i);if(e){var o=$("#"+t.options.id+"_content_tbody").find("tr[groupValue="+i+"]");if(o.length>0){var n=createContentGroupSumRowTd.call(t,e);o.html(n)}else{var n=t.createContentGroupSumRow(e),s=$("#"+t.options.id+"_content_tbody").find("td:contains("+i+")");if(s.length>0){var r=s[s.length-1],o=$(r).closest("tr"),d=o.parent().find('tr[role="row"]').index(o[0]);if(o[0].insertAdjacentHTML("afterEnd",n),t.options.multiSelect){var l=t.createContentLetGroupSumRow("multiSelect",i);$("#"+t.options.id+"_content_multiSelect").find("div")[d].insertAdjacentHTML("afterEnd",l)}if(t.options.showNumCol){var a=t.createContentLetGroupSumRow("numCol",i);$("#"+t.options.id+"_content_numCol").find("div")[d].insertAdjacentHTML("afterEnd",a)}}}}else{var o=$("#"+t.options.id+"_content_tbody").find("tr[groupValue="+i+"]");if(o.length>0){if(o.remove(),t.options.showNumCol){var h=$("#"+t.options.id+"_content_numCol").find("span[groupValue="+i+"]");h.remove()}if(t.options.multiSelect){var h=$("#"+t.options.id+"_content_multiSelect").find("span[groupValue="+i+"]");h.remove()}}}}),this.resetLeftHeightGroupSumFun()),this.repairGroupSumRowArr=[]},resetLeftHeightGroupSumFun$1=function(){if((this.options.showNumCol||this.options.multiSelect)&&this.options.groupSumRow)for(var t=$("#"+this.options.id+'_content_tbody tr[role="groupsumrow"]'),i=$("#"+this.options.id+"_content_numCol span"),e=$("#"+this.options.id+"_content_multiSelect > span"),o=0;o<t.length;o++){var n=t[o].offsetHeight;i[o]&&(i[o].style.height=n+"px"),e[o]&&(e[o].style.height=n+"px")}},renderTypeGroupSumRow$1=function(t,i,e,o){var n=this,s=t.options.sumCol,r=this.options.groupField;if(s&&r){var d=this.getString($(o.value).attr(r),""),l=t.options.groupSumRenderType,a=t.options.dataType,h=!0===e?"fixed_":"",u=$("#"+this.options.id+"_content_"+h+"group_sum_row_"+d).find("td").eq(i).find("span"),c=u[u.length-1];if(c)if("function"==typeof l){var p=$(c).attr("value"),m={};m.value=p,m.element=c,m.gridObj=n,m.gridCompColumn=t,l.call(n,m)}else"integer"!=a&&"float"!=a||(c.style.textAlign="right")}},groupSumRowFunObj={createContentGroupSumRow:createContentGroupSumRow,createContentLetGroupSumRow:createContentLetGroupSumRow,repairGroupSumRow:repairGroupSumRow$1,resetLeftHeightGroupSumFun:resetLeftHeightGroupSumFun$1,renderTypeGroupSumRow:renderTypeGroupSumRow$1},gridComp=function t(i,e){classCallCheck(this,t),this.init(i,e),this.initGrid()},gridCompProto=gridComp.prototype;Object.assign(gridCompProto,createFunObj),Object.assign(gridCompProto,createCalFunOjb),Object.assign(gridCompProto,eventFunObj),Object.assign(gridCompProto,getFunObj),Object.assign(gridCompProto,initFunObj$2),Object.assign(gridCompProto,operateRowFunObj),Object.assign(gridCompProto,renderTypeFunObj),Object.assign(gridCompProto,setFunObj),Object.assign(gridCompProto,wdChangeFunObj),Object.assign(gridCompProto,clickFunObj),Object.assign(gridCompProto,otherFunObj),Object.assign(gridCompProto,utilFunOjb);var oldInitGridCompColumn=gridCompProto.initGridCompColumn,oldInitEventFun=gridCompProto.initEventFun,oldInitGridEventFun=gridCompProto.initGridEventFun;gridCompProto.initGridCompColumnColumnMenuFun=re_initGridCompColumnColumnMenuFun,gridCompProto.initGridCompColumn=function(){oldInitGridCompColumn.apply(this,arguments),colMenu_initGridCompColumn.apply(this,arguments)},gridCompProto.createColumnMenu=re_createColumnMenu,gridCompProto.initEventFun=function(){oldInitEventFun.apply(this,arguments),colMenu_initEventFun.apply(this,arguments)},gridCompProto.initGridEventFun=function(){oldInitGridEventFun.apply(this,arguments),colMenu_initGridEventFun.apply(this,arguments)},void 0===gridCompProto.saveGridCompColumnArrToLocal&&(gridCompProto.saveGridCompColumnArrToLocal=function(){}),void 0===gridCompProto.clearLocalData&&(gridCompProto.clearLocalData=function(){});var oldInitEventFun_grag=gridCompProto.initEventFun,oldInitGridEventFun_grag=gridCompProto.initGridEventFun;Object.assign(gridCompProto,dragFunObj),gridCompProto.initEventFun=function(){oldInitEventFun_grag.apply(this,arguments),dragFunObj.drag_initEventFun.apply(this,arguments)},gridCompProto.initGridEventFun=function(){oldInitGridEventFun_grag.apply(this,arguments),dragFunObj.drag_initGridEventFun.apply(this,arguments)},void 0===gridCompProto.saveGridCompColumnArrToLocal&&(gridCompProto.saveGridCompColumnArrToLocal=function(){});var oldInitEventFun_edit=gridCompProto.initEventFun;Object.assign(gridCompProto,eidtFunObj),void 0===gridCompProto.formEditCell&&(gridCompProto.formEditCell=function(){}),gridCompProto.initEventFun=function(){oldInitEventFun_edit.apply(this,arguments),eidtFunObj.edit_initEventFun.apply(this,arguments)};var oldInitDefault=gridCompProto.initDefault,oldSetRequired=gridCompProto.setRequired;Object.assign(gridCompProto,editFromFunObj),gridCompProto.initDefault=function(){oldInitDefault.apply(this,arguments),editFromFunObj.editForm_initDefault.apply(this,arguments)},gridCompProto.setRequired=function(){oldSetRequired.apply(this,arguments),editFromFunObj.editForm_setRequired.apply(this,arguments)};var oldColumnsVisibleFun=gridCompProto.columnsVisibleFun;Object.assign(gridCompProto,fixFunObj),gridCompProto.columnsVisibleFun=function(){oldColumnsVisibleFun.apply(this,arguments),fixFunObj.fixed_columnsVisibleFun.apply(this,arguments)},Object.assign(gridCompProto,formShowFunOjb),Object.assign(gridCompProto,headerLevelFunObj),Object.assign(gridCompProto,localStorageFunObj),Object.assign(gridCompProto,overWidthHiddenFunObj);var oldInitEventFun_sort=gridCompProto.initEventFun,oldInitGridEventFun_sort=gridCompProto.initGridEventFun;Object.assign(gridCompProto,sortFunObj),gridCompProto.initEventFun=function(){oldInitEventFun_sort.apply(this,arguments),sortFunObj.sort_initEventFun.apply(this,arguments)},gridCompProto.initGridEventFun=function(){oldInitGridEventFun_sort.apply(this,arguments),sortFunObj.sort_initGridEventFun.apply(this,arguments)},Object.assign(gridCompProto,sumRowFunObj);var oldInitEventFun_swap=gridCompProto.initEventFun,oldInitGridEventFun_swap=gridCompProto.initGridEventFun;Object.assign(gridCompProto,swapFunObj),gridCompProto.initEventFun=function(){oldInitEventFun_swap.apply(this,arguments),swapFunObj.swap_initEventFun.apply(this,arguments)},gridCompProto.initGridEventFun=function(){oldInitGridEventFun_swap.apply(this,arguments),swapFunObj.swap_initGridEventFun.apply(this,arguments)};var oldInitGridEventFun_rowDrag=gridCompProto.initGridEventFun;Object.assign(gridCompProto,rowDragFunObj),gridCompProto.initGridEventFun=function(){oldInitGridEventFun_rowDrag.apply(this,arguments),rowDragFunObj.rowDrag_initGridEventFun.apply(this,arguments)},Object.assign(gridCompProto,treeFunObj),Object.assign(gridCompProto,groupFunObj),Object.assign(gridCompProto,groupSumRowFunObj);var old=$.fn.grid;$.fn.grid=function(t){var i=$(this).data("gridComp");return i||$(this).data("gridComp",i=new gridComp(this,t)),i},$.fn.grid.gridComp=gridComp,$.fn.grid.gridCompColumn=column,$.fn.grid.dataSource=dataSource,$.fn.grid.noConflict=function(){return $.fn.grid=old,this}}();
